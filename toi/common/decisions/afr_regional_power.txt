afr_regional_power_empire_politics_category = {

	afr_empire_politics_annex_subject_decision = {

		icon = generic_nationalism

		available = {
			if = {
				limit = { 
					ROOT = { num_subjects > 0 }
					FROM = { is_subject_of = ROOT }
				}
				if = {
					limit = { 
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						FROM = { has_autonomy_state = autonomy_afr_empire_level_4 }
					}
					FROM = { compare_autonomy_progress_ratio < 0.01 }
				}
				else_if = {
					limit = {
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						FROM = { has_autonomy_state = autonomy_afr_empire_level_3 }
					}
					FROM = { compare_autonomy_progress_ratio < 0.01 }
				}
				else_if = {
					limit = { 
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						FROM = { has_autonomy_state = autonomy_afr_empire_level_2 }
					}
					FROM = { compare_autonomy_progress_ratio < 0.01 }
				}
				else_if = {
					limit = { 
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						FROM = { has_autonomy_state = autonomy_afr_empire_level_1 }
					}
					FROM = { compare_autonomy_progress_ratio < 0.01 }
				}
				else = { FROM = { compare_autonomy_progress_ratio < 0.01 } }
			}
			else_if = {
				limit = { 
					ROOT = { is_subject_of = FROM }
				}
				if = {
					limit = { 
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						ROOT = { has_autonomy_state = autonomy_afr_empire_level_4 }
					}
					afr_empire_raise_autonomy_level_progress_check = yes
					ROOT = { compare_autonomy_progress_ratio > 0.99 }
				}
				else_if = {
					limit = { 
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						ROOT = { has_autonomy_state = autonomy_afr_empire_level_3 }
					}
					afr_empire_raise_autonomy_level_progress_check = yes
					ROOT = { compare_autonomy_progress_ratio > 0.99 }
				}
				else_if = {
					limit = { 
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						ROOT = { has_autonomy_state = autonomy_afr_empire_level_2 }
					}
					afr_empire_raise_autonomy_level_progress_check = yes
					ROOT = { compare_autonomy_progress_ratio > 0.99 }
				}
				else_if = {
					limit = { 
						OR = {
							has_dlc = "Together for Victory"
							has_dlc = "Waking the Tiger"
							has_dlc = "Death or Dishonor"
						}
						ROOT = { has_autonomy_state = autonomy_afr_empire_level_1 }
					}
					afr_empire_raise_autonomy_level_progress_check = yes
					ROOT = { compare_autonomy_progress_ratio > 0.99 }
				}
				else = { 
					afr_empire_raise_autonomy_level_progress_check = yes
					ROOT = { compare_autonomy_progress_ratio > 0.99 } 
				}
			}
		}
		allowed = { 
			afr_is_tribal_allowed = yes
		}
		visible = {
			OR = {
				ROOT = { is_subject_of = FROM }
				FROM = { is_subject_of = ROOT }
			}
		}
		
		target_trigger = {
			FROM = { afr_is_tribal = yes }
			afr_is_tribal = yes
			OR = {
				ROOT = { is_subject_of = FROM }
				FROM = { is_subject_of = ROOT }
			}
		}
		fire_only_once = no
		days_re_enable = 360
		cost = 0
		
		complete_effect = {
			#country_event sent to subject about annexation
		}

		ai_will_do = {
			base = 100
		}
	}
	
	afr_empire_politics_subject_levy_mission = {
		icon = generic_political_actions
		available = {
			if = {
				limit = { has_country_flag = afr_empire_politics_subject_levy_mission_large_flag }
				OR = {
					custom_trigger_tooltip = {
						tooltip = EDC_Tribal_Horse_Army_over_3000
						check_variable = { Tribal_horse_army_num > 3000 }
					}
					custom_trigger_tooltip = {
						tooltip = EDC_Tribal_Army_over_6000
						check_variable = { Tribal_army_num > 6000 }
					}
					custom_trigger_tooltip = {
						tooltip = afr_prosperity_mechanic_greater_than_20
						check_variable = { afr_prosperity_mechanic_value > 20 }
					}
				}
			}
			if = {
				limit = { has_country_flag = afr_empire_politics_subject_levy_mission_medium_flag }
				OR = {
					custom_trigger_tooltip = {
						tooltip = EDC_Tribal_Horse_Army_over_2000
						check_variable = { Tribal_horse_army_num > 2000 }
					}
					custom_trigger_tooltip = {
						tooltip = EDC_Tribal_Army_over_4000
						check_variable = { Tribal_army_num > 4000 }
					}
					custom_trigger_tooltip = {
						tooltip = afr_prosperity_mechanic_greater_than_15
						check_variable = { afr_prosperity_mechanic_value > 15 }
					}
				}
			}
			if = {
				limit = { has_country_flag = afr_empire_politics_subject_levy_mission_small_flag }
				OR = {
					custom_trigger_tooltip = {
						tooltip = EDC_Tribal_Horse_Army_over_1000
						check_variable = { Tribal_horse_army_num > 1000 }
					}
					custom_trigger_tooltip = {
						tooltip = EDC_Tribal_Army_over_2000
						check_variable = { Tribal_army_num > 2000 }
					}
					custom_trigger_tooltip = {
						tooltip = afr_prosperity_mechanic_greater_than_10
						check_variable = { afr_prosperity_mechanic_value > 10 }
					}
				}
			}
		}
		activation = { always = no }
		days_mission_timeout = 90
		selectable_mission = yes
		is_good = yes
		fire_only_once = no
		
		cancel_trigger = {
			is_subject = no
		}
		complete_effect = {
			if = {
				limit = { is_subject = yes }
				OVERLORD = { country_event = { id = afr_empire_politics_subject_levy_mission_event.1 random_days = 5 } }
			}
		}
		timeout_effect = {
			if = {
				limit = { 
					is_subject = yes 
					if = {
						limit = { has_country_flag = afr_empire_politics_subject_levy_mission_large_flag }
						OR = {
							check_variable = { Tribal_horse_army_num > 3000 }
							check_variable = { Tribal_army_num > 6000 }
							check_variable = { afr_prosperity_mechanic_value > 20 }
						}
					}
					if = {
						limit = { has_country_flag = afr_empire_politics_subject_levy_mission_medium_flag }
						OR = {
							check_variable = { Tribal_horse_army_num > 2000 }
							check_variable = { Tribal_army_num > 4000 }
							check_variable = { afr_prosperity_mechanic_value > 15 }
						}
					}
					if = {
						limit = { has_country_flag = afr_empire_politics_subject_levy_mission_small_flag }
						OR = {
							check_variable = { Tribal_horse_army_num > 1000 }
							check_variable = { Tribal_army_num > 2000 }
							check_variable = { afr_prosperity_mechanic_value > 10 }
						}
					}
				}
				OVERLORD = { country_event = { id = afr_empire_politics_subject_levy_mission_event.1 random_days = 5 } }
			}
			else_if = {
				limit = { is_subject = yes }
				OVERLORD = { country_event = { id = afr_empire_politics_subject_levy_mission_event.4 random_days = 5 } }
			}
			hidden_effect = {
				clr_country_flag = afr_empire_politics_subject_levy_mission_large_flag
				clr_country_flag = afr_empire_politics_subject_levy_mission_medium_flag
				clr_country_flag = afr_empire_politics_subject_levy_mission_small_flag
			}
		}
	}
	
	afr_empire_politics_independence_struggle = {
		
		icon = generic_independence
		
		available = {
			custom_trigger_tooltip = {
				tooltip = afr_empire_politics_independence_struggle_trigger_tooltip
				check_variable = { ROOT.afr_empire_subject_loyalty_var < 0 }
			}
			#OR = {
			#	has_stability > 0.5
			#	has_war_support > 0.25
			#	ROOT = {
			#		OVERLORD = {
			#			has_stability < 0.35
			#		}
			#	}
			#}
		}
		
		visible = {
			is_subject = yes
			OR = {
				has_autonomy_state = autonomy_afr_empire_level_1
				has_autonomy_state = autonomy_afr_empire_level_2
				has_autonomy_state = autonomy_afr_empire_level_3
				has_autonomy_state = autonomy_afr_empire_level_4
			}
		}
		
		fire_only_once = no
		
		days_re_enable = 500 
		
		days_remove = 14
		
		cost = 100
		custom_cost_trigger = {

			command_power > 99.9

		}
		custom_cost_text = afr_empire_politics_independence_struggle_command_power_cost
		
		complete_effect = {
			add_timed_idea = {
				idea = eoanb_idea_independence_struggle
				days = 90
			}
			hidden_effect = {
				add_command_power = -100
				ROOT = {
					OVERLORD = { country_event = { id = independence.1 } }
				}
			}
		}
		
		modifier = {
			political_power_gain = -0.25
		}
		
		remove_effect = {
			country_event = { id = independence.2 }
		}
		
		#AI can be incited to do this, will add later
		ai_will_do = {
			base = 0
		}
	}
	
	afr_empire_politics_subject_send_tribute_to_overlord_decision = {

		icon = generic_political_discourse

		available = {
			custom_trigger_tooltip = {
				tooltip = afr_prosperity_mechanic_greater_than_10
				check_variable = { afr_prosperity_mechanic_value > 9 }
			}
		}
		allowed = { 
			afr_is_tribal_allowed = yes
		}
		visible = {
			afr_is_tribal = yes
			is_subject = yes
			OVERLORD = { afr_is_tribal = yes }
		}
		days_remove = 180
		fire_only_once = no
		cost = 10
		custom_cost_trigger = {
			check_variable = { afr_prosperity_mechanic_value > 9 }
		}
		custom_cost_text = afr_prosperity_mechanic_custom_cost_10
		complete_effect = {
			hidden_effect = { add_to_variable = { var = afr_prosperity_mechanic_value value = -10 } }
			OVERLORD = { country_event = { id = afr_empire_politics_subject_send_tribute_to_overlord_event.1 random_days = 7 } }
		}
		ai_will_do = {
			factor = 4
			modifier = {
				factor = 20
				compare_autonomy_progress_ratio < 0.05
			}
			modifier = {
				factor = 10
				compare_autonomy_progress_ratio < 0.10
			}
			modifier = {
				factor = 0
				has_active_mission = afr_decision_internal_tribal_coup
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_country_flag = afr_reforming_regional_power_regional_resources_focus
					NOT = { has_country_flag = afr_reforming_regional_power_regional_resources_completed }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_country_flag = afr_reforming_regional_power_regional_industry_focus
					NOT = { has_country_flag = afr_reforming_regional_power_regional_industry_completed }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_country_flag = afr_reforming_regional_power_regional_infrastructure_focus
					NOT = { has_country_flag = afr_reforming_regional_power_regional_infrastructure_completed }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_completed_focus = ETH_clear_space_for_industry
					OR = {
						NOT = { has_completed_focus = ETH_reforming_regional_power_regional_resources }
						NOT = { has_completed_focus = ETH_reforming_regional_power_regional_infrastructure }
						NOT = { has_completed_focus = ETH_reforming_regional_power_regional_industry }
					}
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_completed_focus = ETH_clear_space_for_industry
					has_completed_focus = ETH_train_defensive_tactics
					NOT = { has_completed_focus = ETH_plan_military_infrastructure }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_completed_focus = ETH_adress_education
					NOT = { has_completed_focus = ETH_western_inspired_university }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_completed_focus = ETH_study_artillery
					NOT = { has_completed_focus = ETH_foreign_artillery_instructors }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					OR = {
						has_completed_focus = afr_improve_our_army
						has_completed_focus = afr_create_naval_designs
					}
					NOT = { has_completed_focus = afr_reforming_regional_power_regional_investment }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_completed_focus = afr_reforming_regional_power_regional_investment
					OR = {
						NOT = { has_completed_focus = afr_reforming_regional_power_regional_resources }
						NOT = { has_completed_focus = afr_reforming_regional_power_regional_infrastructure }
						NOT = { has_completed_focus = afr_reforming_regional_power_regional_industry }
					}
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					OR = {
						has_completed_focus = afr_mechanical_engineering_research
						has_completed_focus = afr_electronic_device_production
					}
					NOT = { has_completed_focus = afr_expand_research_facilities }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_completed_focus = afr_dirt_to_paved_roads
					NOT = { has_completed_focus = afr_regular_road_matenece }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					has_completed_focus = afr_military_technology_development
					NOT = { has_completed_focus = afr_military_production_streamlining }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				AND = {
					AND = {
						has_completed_focus = afr_plan_a_naval_force
						has_completed_focus = afr_reforming_regional_power_regional_infrastructure
					}
					NOT = { has_completed_focus = afr_build_a_port }
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
			modifier = {
				factor = 0
				check_variable = { afr_prosperity_mechanic_value < 80 }
				if = {
					limit = { 
						all_owned_state = { naval_base < 1 }
					}
					custom_trigger_tooltip = {
						tooltip = Ocenaia_has_infrastructure_to_support_new_buildings_on_coast
						Oceania_one_extra_building_slots_supported_for_coast_not_core_trigger = yes
					}
				}
				else = {
					any_owned_state = {
						is_coastal = yes
						naval_base > 0
					}
				}
				OR = {
					AND = {
						has_completed_focus = afr_inward_regional_power_expanding_our_regional_power
						NOT = { has_completed_focus = afr_inward_regional_power_establish_port_town }
					}
					AND = {
						has_completed_focus = afr_jihadist_regional_power_expanding_our_regional_power
						NOT = { has_completed_focus = afr_jihadist_regional_power_establish_port_town }
					}
				}
				NOT = { compare_autonomy_progress_ratio < 0.10 }
			}
		}
	}
	
	afr_empire_politics_increase_own_autonomy = {
		
		icon = generic_break_treaty
		
		available = {
			if = {
				limit = {
					OR = {
						has_dlc = "Together for Victory"
						has_dlc = "Waking the Tiger"
						has_dlc = "Death or Dishonor"
					}
				}
				custom_trigger_tooltip = {
					tooltip = afr_empire_politics_is_a_vassal_trigger_tooltip
					OR = {
						has_autonomy_state = autonomy_afr_empire_level_1
						has_autonomy_state = autonomy_afr_empire_level_2
					}
				}
			}
			else = {
				compare_autonomy_progress_ratio < 0.50
			}
			custom_trigger_tooltip = {
				tooltip = afr_empire_politics_atleast_org_tribe_trigger_tooltip
				NOT = {
					has_idea = AF_T_unorganized_tribal_nation
					has_idea = AF_T_unorganized_tribal_nation_2
					has_idea = AF_T_unorganized_tribal_nation_3
					has_idea = AF_T_unorganized_tribal_nation_4
					has_idea = AF_T_unorganized_tribal_nation_5
				}
			}
			custom_trigger_tooltip = {
				tooltip = afr_empire_politics_increase_own_autonomy_trigger_tooltip
				check_variable = { ROOT.afr_empire_subject_loyalty_var > 5 }
			}
		}
		
		visible = {
			is_subject = yes
			OR = {
				has_autonomy_state = autonomy_afr_empire_level_1
				has_autonomy_state = autonomy_afr_empire_level_2
				has_autonomy_state = autonomy_afr_empire_level_3
				has_autonomy_state = autonomy_afr_empire_level_4
			}
			compare_autonomy_progress_ratio < 0.99
			compare_autonomy_progress_ratio > 0.01
		}
		
		fire_only_once = no
		
		days_re_enable = 180  
		
		days_remove = 90
		
		cost = 0
		
		complete_effect = {
			custom_effect_tooltip = afr_tt_decision_increase_autonomy
			hidden_effect = {
				random_list = {
					40 = {
						#Overlord discovers it, not done yet
						add_political_power = 1
					}
					60 = {
						#Successfully stay "hidden"
						add_political_power = 1
					}
				}
			}
		}
		
		modifier = {
			political_power_gain = -1
			autonomy_gain = 1
		}
		
		remove_effect = {
			add_stability = -0.02
		}
		
		ai_will_do = {
			base = 0
		}
	}

}


afr_inward_regional_power_sprawl = {

	afr_inward_guarantee_roads_in_conquered_lands_decision = {

		icon = generic_political_discourse

		available = {
			has_war = no
			custom_trigger_tooltip = {
				tooltip = AFR_dirt_roads_requirement_tooltip
				any_owned_state = { infrastructure < 1 }
			}
			afr_is_tribal = yes
			custom_trigger_tooltip = {
				tooltip = AFR_constructing_dirt_roads_tooltip
				NOT = { has_country_flag = AFR_constructing_dirt_roads }
			}
		}
		allowed = { 
			afr_is_tribal_allowed = yes
		}
		visible = {
			ROOT = {
				afr_is_tribal = yes
				has_country_flag = afr_inward_guarantee_roads_in_conquered_lands
				NOT = { has_country_flag = AFR_constructing_dirt_roads }
			}
			all_owned_state = {
				infrastructure < 1
			}
		}
		
		days_remove = 360
		fire_only_once = no

		cost = 50
		
		cancel_trigger = {
			all_owned_state = {
				infrastructure > 0
			}
		}
		
		complete_effect = {
			set_country_flag = AFR_constructing_dirt_roads
		}
		modifier = {
			civilian_factory_use = 1
		}
		remove_effect = {
			random_owned_controlled_state = {
				limit = {
					infrastructure < 1
				}
				add_building_construction  = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}

		ai_will_do = {
			base = 1
		}
	}
}

afr_inward_regional_power_imperial_expansion = {
	

	afr_inward_regional_power_consolidate_neighboring_tribes = {
		icon = generic_prepare_civil_war
		available = {
			has_war = no
			custom_trigger_tooltip = {
				tooltip = afr_war_exhaustion_value_less_than_10
				check_variable = {
					afr_war_exhaustion_value < 10
				}
			}
			custom_trigger_tooltip = {
				tooltip = first_nations_tribal_raid_neighbor_diplomacy_trigger
				NOT = { has_non_aggression_pact_with = FROM }
				check_variable = { var = ROOT.afr_has_special_diplomacy@FROM value = 0 compare = equals }
				NOT = {
					check_variable = { var = FROM.afr_regional_power_peace_treaty@ROOT value = 1 compare = greater_than_or_equals }
					check_variable = { var = ROOT.afr_regional_power_peace_treaty@FROM value = 1 compare = greater_than_or_equals }
				}
			}
		}
		allowed = { 
			afr_is_tribal_allowed = yes
		}
		visible = {
			ROOT = { has_country_flag = afr_inward_regional_power_expansion_wars_tribes_flag }
			ROOT = { NOT = { has_country_flag = afr_inward_preparing_expansion_war_flag } }
			ROOT = { is_subject = no }
			country_exists = FROM
		}
		
		target_trigger = {
			if = {
				limit = { has_idea = WDD_KBO_TRUCE }
				FROM = {
					OR = {
						has_idea = AF_T_unorganized_tribal_nation
						has_idea = AF_T_unorganized_tribal_nation_2
						has_idea = AF_T_unorganized_tribal_nation_3
						has_idea = AF_T_unorganized_tribal_nation_4
						has_idea = AF_T_unorganized_tribal_nation_5
						has_idea = AF_T_organized_tribal_nation
						has_idea = AF_T_organized_tribal_nation_2
						has_idea = AF_T_organized_tribal_nation_3
					}
					NOT = { has_idea = WDD_KBO_TRUCE }
					#afr_is_tribal = yes
				}
			}
			if = {
				limit = { 
					FROM = {
						is_subject = yes
					}
				}
				
				FROM = {
					OVERLORD = {
						NOT = { has_idea = afr_large_kingdom }
						NOT = { has_idea = afr_reforming_kingdom }
					}
					OR = {
						has_idea = AF_T_unorganized_tribal_nation
						has_idea = AF_T_unorganized_tribal_nation_2
						has_idea = AF_T_unorganized_tribal_nation_3
						has_idea = AF_T_unorganized_tribal_nation_4
						has_idea = AF_T_unorganized_tribal_nation_5
						has_idea = AF_T_organized_tribal_nation
						has_idea = AF_T_organized_tribal_nation_2
						has_idea = AF_T_organized_tribal_nation_3
					}
					#afr_is_tribal = yes
				}
			}
			else = {
				FROM = {
					OR = {
						has_idea = AF_T_unorganized_tribal_nation
						has_idea = AF_T_unorganized_tribal_nation_2
						has_idea = AF_T_unorganized_tribal_nation_3
						has_idea = AF_T_unorganized_tribal_nation_4
						has_idea = AF_T_unorganized_tribal_nation_5
						has_idea = AF_T_organized_tribal_nation
						has_idea = AF_T_organized_tribal_nation_2
						has_idea = AF_T_organized_tribal_nation_3
					}
					#afr_is_tribal = yes
				}
			}
			FROM = { NOT = { is_subject_of = ROOT } }
			FROM = { NOT = { is_in_faction_with = ROOT } }
			OR = {
				any_country = {
					AND = { 
						is_subject_of = ROOT
						is_neighbor_of = FROM
					}
				}
				FROM = { is_neighbor_of = ROOT }
			}
		}
		
		custom_cost_trigger = {
			command_power > 99.9
		}
		custom_cost_text = afr_regional_power_command_power_100
	
		fire_only_once = no
		days_remove = 60
		days_re_enable = 360
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 4
				has_war_support > 0.5
			}
			modifier = {
				factor = 2
				FROM = {
					any_owned_state = {
						any_neighbor_state = {
							is_in_home_area = yes
							is_owned_by = ROOT
						}
					}
				}
			}
		}
		
		modifier = {
			ai_desired_divisions_factor = 1
			command_power_gain_mult = -1
		}
		
		complete_effect = {
			hidden_effect = { add_command_power = -100 }
			custom_effect_tooltip = afr_war_exhaustion_value_add_3
			add_to_variable = {
				var = afr_war_exhaustion_value
				value = 3
			}
			set_country_flag = afr_inward_preparing_expansion_war_flag
			#if = {
			#	limit = {
			#		FROM = {
			#			is_in_array = {
			#				array = national_religion_array
			#				value = global.sunni
			#			}
			#			has_government = fundamentalism
			#		}
			#	}
			#	FROM = { country_event = { days = 5 id = afr_inward_integration_tribe.1 } }
			#	custom_effect_tooltip = afr_war_exhaustion_value_add_10_if_declined
			#}
			#else = {
				hidden_effect = { FROM = { country_event = { days = 5 id = afr_integration_tribe_warning.1 } } }
				ROOT = {
					add_ai_strategy = {
						type = prepare_for_war
						id = FROM
						value = 200
					}
				}
				FROM = {
					add_ai_strategy = {
						type = prepare_for_war
						id = ROOT
						value = 200
					}
				}
			#}
		}
		
		remove_effect = {
			
			ROOT = {
				add_ai_strategy = {
					type = prepare_for_war
					id = FROM
					value = -200
				}
			}
			FROM = {
				add_ai_strategy = {
					type = prepare_for_war
					id = ROOT
					value = -200
				}
			}
			if = {
				limit = {
					NOT = {
						is_in_faction_with = FROM
						has_war_with = FROM
						FROM = { is_subject_of = ROOT }
					}
					has_country_flag = afr_inward_preparing_expansion_war_flag
				}
				declare_war_on = {
					target = FROM
					type = annex_everything
				}
				hidden_effect = { FROM = { every_owned_state = { add_claim_by = ROOT } } }
				custom_effect_tooltip = afr_war_exhaustion_value_add_10
				add_to_variable = {
					var = afr_war_exhaustion_value
					value = 10
				}
				hidden_effect = {
					set_variable = { ROOT.afr_regional_power_expansion_attacker@FROM = 1 }
					set_variable = { FROM.afr_regional_power_expansion_defender@ROOT = 1 }
				}
			}
			clr_country_flag = afr_inward_preparing_expansion_war_flag
		}
	}
	
	
	afr_inward_regional_power_consolidate_neighboring_small_kingdoms = {
		icon = generic_prepare_civil_war
		available = {
			has_war = no
			custom_trigger_tooltip = {
				tooltip = afr_war_exhaustion_value_less_than_10
				check_variable = {
					afr_war_exhaustion_value < 10
				}
			}
			custom_trigger_tooltip = {
				tooltip = first_nations_tribal_raid_neighbor_diplomacy_trigger
				NOT = { has_non_aggression_pact_with = FROM }
				check_variable = { var = ROOT.afr_has_special_diplomacy@FROM value = 0 compare = equals }
				NOT = {
					check_variable = { var = FROM.afr_regional_power_peace_treaty@ROOT value = 1 compare = greater_than_or_equals }
					check_variable = { var = ROOT.afr_regional_power_peace_treaty@FROM value = 1 compare = greater_than_or_equals }
				}
			}
		}
		allowed = { 
			afr_is_tribal_allowed = yes
		}
		visible = {
			ROOT = { has_country_flag = afr_inward_regional_power_expansion_wars_kingdoms_flag }
			ROOT = { NOT = { has_country_flag = afr_inward_preparing_expansion_war_flag } }
			ROOT = { is_subject = no }
			country_exists = FROM
		}
		
		target_trigger = {
			if = {
				limit = { has_idea = WDD_KBO_TRUCE }
				FROM = {
					has_idea = AF_T_small_kingdom
					NOT = { has_idea = WDD_KBO_TRUCE }
					#afr_is_tribal = yes
				}
			}
			if = {
				limit = { 
					FROM = {
						is_subject = yes
					}
				}
				FROM = {
					OVERLORD = {
						NOT = { has_idea = afr_large_kingdom }
						NOT = { has_idea = afr_reforming_kingdom }
					}
					has_idea = AF_T_small_kingdom
					#afr_is_tribal = yes
				}
			}
			else = {
				FROM = {
					has_idea = AF_T_small_kingdom
					#afr_is_tribal = yes
				}
			}
			FROM = { NOT = { is_subject_of = ROOT } }
			FROM = { NOT = { is_in_faction_with = ROOT } }
			OR = {
				any_country = {
					AND = {
						is_subject_of = ROOT
						is_neighbor_of = FROM
					}
				}
				FROM = { is_neighbor_of = ROOT }
			}
		}
	
		custom_cost_trigger = {
			command_power > 99.9
		}
		custom_cost_text = afr_regional_power_command_power_100
		
		fire_only_once = no
		days_remove = 60
		days_re_enable = 360
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 4
				has_war_support > 0.5
			}
			modifier = {
				factor = 2
				FROM = {
					any_owned_state = {
						any_neighbor_state = {
							is_in_home_area = yes
							is_owned_by = ROOT
						}
					}
				}
			}
		}
		
		modifier = {
			ai_desired_divisions_factor = 1
			command_power_gain_mult = -1
		}
		
		complete_effect = {
			hidden_effect = { add_command_power = -100 }
			custom_effect_tooltip = afr_war_exhaustion_value_add_5
			add_to_variable = {
				var = afr_war_exhaustion_value
				value = 5
			}
			set_country_flag = afr_inward_preparing_expansion_war_flag
			FROM = { country_event = { days = 5 id = afr_inward_integration_kingdom.1 } }
			custom_effect_tooltip = afr_war_exhaustion_value_add_15_if_declined
		}
		
		cancel_trigger = {
			OR = {
				is_in_faction_with = FROM
				has_war_with = FROM
				FROM = { is_subject_of = ROOT }
				hidden_trigger = { NOT = { has_country_flag = afr_inward_preparing_expansion_war_flag } }
			}
		}
		
	}
}


afr_jihadist_regional_power_caliphate_wars = {
	afr_jihadist_regional_power_consolidate_neighboring_tribes = {
		icon = generic_prepare_civil_war
		available = {
			has_war = no
			if = {
				limit = {
					has_country_flag = SKT_jihad_formed
				}
				custom_trigger_tooltip = {
					tooltip = afr_war_exhaustion_value_less_than_40
					check_variable = {
						afr_war_exhaustion_value < 40
					}
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = afr_war_exhaustion_value_less_than_10
					check_variable = {
						afr_war_exhaustion_value < 10
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = first_nations_tribal_raid_neighbor_diplomacy_trigger
				NOT = { has_non_aggression_pact_with = FROM }
				check_variable = { var = ROOT.afr_has_special_diplomacy@FROM value = 0 compare = equals }
				NOT = {
					check_variable = { var = FROM.afr_regional_power_peace_treaty@ROOT value = 1 compare = greater_than_or_equals }
					check_variable = { var = ROOT.afr_regional_power_peace_treaty@FROM value = 1 compare = greater_than_or_equals }
				}
			}
		}
		allowed = { 
			afr_is_tribal_allowed = yes
		}

		visible = {
			ROOT = { has_country_flag = afr_jihadist_regional_power_caliphate_wars_tribes_flag }
			ROOT = { NOT = { has_country_flag = afr_jihadist_preparing_caliphate_war_flag } }
			ROOT = { is_subject = no }
			country_exists = FROM
		}
		
		target_trigger = {
			if = {
				limit = { has_idea = WDD_KBO_TRUCE }
				FROM = {
					OR = {
						has_idea = AF_T_unorganized_tribal_nation
						has_idea = AF_T_unorganized_tribal_nation_2
						has_idea = AF_T_unorganized_tribal_nation_3
						has_idea = AF_T_unorganized_tribal_nation_4
						has_idea = AF_T_unorganized_tribal_nation_5
						has_idea = AF_T_organized_tribal_nation
						has_idea = AF_T_organized_tribal_nation_2
						has_idea = AF_T_organized_tribal_nation_3
					}
					NOT = { has_idea = WDD_KBO_TRUCE }
					#afr_is_tribal = yes
				}
			}
			if = {
				limit = { 
					FROM = {
						is_subject = yes
					}
				}
				
				FROM = {
					OVERLORD = {
						NOT = { has_idea = afr_large_kingdom }
						NOT = { has_idea = afr_reforming_kingdom }
					}
					OR = {
						has_idea = AF_T_unorganized_tribal_nation
						has_idea = AF_T_unorganized_tribal_nation_2
						has_idea = AF_T_unorganized_tribal_nation_3
						has_idea = AF_T_unorganized_tribal_nation_4
						has_idea = AF_T_unorganized_tribal_nation_5
						has_idea = AF_T_organized_tribal_nation
						has_idea = AF_T_organized_tribal_nation_2
						has_idea = AF_T_organized_tribal_nation_3
					}
					#afr_is_tribal = yes
				}
			}
			else = {
				FROM = {
					OR = {
						has_idea = AF_T_unorganized_tribal_nation
						has_idea = AF_T_unorganized_tribal_nation_2
						has_idea = AF_T_unorganized_tribal_nation_3
						has_idea = AF_T_unorganized_tribal_nation_4
						has_idea = AF_T_unorganized_tribal_nation_5
						has_idea = AF_T_organized_tribal_nation
						has_idea = AF_T_organized_tribal_nation_2
						has_idea = AF_T_organized_tribal_nation_3
					}
					#afr_is_tribal = yes
				}
			}
			FROM = { NOT = { is_subject_of = ROOT } }
			FROM = { NOT = { is_in_faction_with = ROOT } }
			OR = {
				any_country = {
					AND = { 
						is_subject_of = ROOT
						is_neighbor_of = FROM
					}
				}
				FROM = { is_neighbor_of = ROOT }
			}
		}
		
		custom_cost_trigger = {
			command_power > 99.9
		}
		custom_cost_text = afr_regional_power_command_power_100
	
		fire_only_once = no
		days_remove = 60
		days_re_enable = 360
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 4
				has_war_support > 0.5
			}
			modifier = {
				factor = 2
				FROM = {
					any_owned_state = {
						any_neighbor_state = {
							is_in_home_area = yes
							is_owned_by = ROOT
						}
					}
				}
			}
		}
		
		modifier = {
			ai_desired_divisions_factor = 1
			command_power_gain_mult = -1
		}
		
		complete_effect = {
			hidden_effect = { add_command_power = -100 }
			custom_effect_tooltip = afr_war_exhaustion_value_add_3
			add_to_variable = {
				var = afr_war_exhaustion_value
				value = 3
			}
			set_country_flag = afr_jihadist_preparing_caliphate_war_flag
			if = {
				limit = {
					FROM = {
						is_in_array = {
							array = national_religion_array
							value = global.sunni
						}
						has_government = fundamentalism
					}
				}
				FROM = { country_event = { days = 5 id = afr_caliphate_integration_tribe.1 } }
				custom_effect_tooltip = afr_war_exhaustion_value_add_10_if_declined
			}
			else = {
				hidden_effect = { FROM = { country_event = { days = 5 id = afr_integration_tribe_warning.1 } } }
				ROOT = {
					add_ai_strategy = {
						type = prepare_for_war
						id = FROM
						value = 200
					}
				}
				FROM = {
					add_ai_strategy = {
						type = prepare_for_war
						id = ROOT
						value = 200
					}
				}
			}
		}
		
		remove_effect = {
			ROOT = {
				add_ai_strategy = {
					type = prepare_for_war
					id = FROM
					value = -200
				}
			}
			FROM = {
				add_ai_strategy = {
					type = prepare_for_war
					id = ROOT
					value = -200
				}
			}
			if = {
				limit = {
					NOT = {
						is_in_faction_with = FROM
						has_war_with = FROM
						FROM = { is_subject_of = ROOT }
					}
					has_country_flag = afr_jihadist_preparing_caliphate_war_flag
				}
				declare_war_on = {
					target = FROM
					type = annex_everything
				}
				hidden_effect = { FROM = { every_owned_state = { add_claim_by = ROOT } } }
				custom_effect_tooltip = afr_war_exhaustion_value_add_10
				add_to_variable = {
					var = afr_war_exhaustion_value
					value = 10
				}
				hidden_effect = {
					set_variable = { ROOT.afr_regional_power_expansion_attacker@FROM = 1 }
					set_variable = { FROM.afr_regional_power_expansion_defender@ROOT = 1 }
				}
			}
			clr_country_flag = afr_jihadist_preparing_caliphate_war_flag
		}	
	}
	
	
	afr_jihadist_regional_power_consolidate_neighboring_small_kingdoms = {
		icon = generic_prepare_civil_war
		available = {
			has_war = no
			if = {
				limit = {
					has_country_flag = SKT_jihad_formed
				}
				custom_trigger_tooltip = {
					tooltip = afr_war_exhaustion_value_less_than_40
					check_variable = {
						afr_war_exhaustion_value < 40
					}
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = afr_war_exhaustion_value_less_than_10
					check_variable = {
						afr_war_exhaustion_value < 10
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = first_nations_tribal_raid_neighbor_diplomacy_trigger
				NOT = { has_non_aggression_pact_with = FROM }
				check_variable = { var = ROOT.afr_has_special_diplomacy@FROM value = 0 compare = equals }
				NOT = {
					check_variable = { var = FROM.afr_regional_power_peace_treaty@ROOT value = 1 compare = greater_than_or_equals }
					check_variable = { var = ROOT.afr_regional_power_peace_treaty@FROM value = 1 compare = greater_than_or_equals }
				}
			}
		}
		allowed = { 
			afr_is_tribal_allowed = yes
		}

		visible = {
			ROOT = { has_country_flag = afr_jihadist_regional_power_caliphate_wars_kingdoms_flag }
			ROOT = { NOT = { has_country_flag = afr_jihadist_preparing_caliphate_war_flag } }
			ROOT = { is_subject = no }
			country_exists = FROM
		}
		
		target_trigger = {
			if = {
				limit = { has_idea = WDD_KBO_TRUCE }
				FROM = {
					has_idea = AF_T_small_kingdom
					NOT = { has_idea = WDD_KBO_TRUCE }
					#afr_is_tribal = yes
				}
			}
			if = {
				limit = { 
					FROM = {
						is_subject = yes
					}
				}
				FROM = {
					OVERLORD = {
						NOT = { has_idea = afr_large_kingdom }
						NOT = { has_idea = afr_reforming_kingdom }
					}
					has_idea = AF_T_small_kingdom
					#afr_is_tribal = yes
				}
			}
			else = {
				FROM = {
					has_idea = AF_T_small_kingdom
					#afr_is_tribal = yes
				}
			}
			FROM = { NOT = { is_subject_of = ROOT } }
			FROM = { NOT = { is_in_faction_with = ROOT } }
			OR = {
				any_country = {
					AND = { 
						is_subject_of = ROOT
						is_neighbor_of = FROM
					}
				}
				FROM = { is_neighbor_of = ROOT }
			}
		}
	
		custom_cost_trigger = {
			command_power > 99.9
		}
		custom_cost_text = afr_regional_power_command_power_100
		
		fire_only_once = no
		days_remove = 60
		days_re_enable = 360
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 4
				has_war_support > 0.5
			}
			modifier = {
				factor = 2
				FROM = {
					any_owned_state = {
						any_neighbor_state = {
							is_in_home_area = yes
							is_owned_by = ROOT
						}
					}
				}
			}
		}
		
		modifier = {
			ai_desired_divisions_factor = 1
			command_power_gain_mult = -1
		}
		
		complete_effect = {
			hidden_effect = { add_command_power = -100 }
			custom_effect_tooltip = afr_war_exhaustion_value_add_5
			add_to_variable = {
				var = afr_war_exhaustion_value
				value = 5
			}
			set_country_flag = afr_jihadist_preparing_caliphate_war_flag
			FROM = { country_event = { days = 5 id = afr_caliphate_integration_kingdom.1 } }
			custom_effect_tooltip = afr_war_exhaustion_value_add_15_if_declined
		}
		
		cancel_trigger = {
			OR = {
				is_in_faction_with = FROM
				has_war_with = FROM
				FROM = { is_subject_of = ROOT }
				hidden_trigger = { NOT = { has_country_flag = afr_jihadist_preparing_caliphate_war_flag } }
			}
		}
		
	}
}