add_namespace = secondopiumwar
add_namespace = secondopiumwarnews

#FRA learns about Chapdelaine's Execution
country_event = {
	id = secondopiumwar.1
	title = secondopiumwar.1.t
	desc = secondopiumwar.1.d
	picture = GFX_report_event_usa_funeral

	fire_only_once = yes
	trigger = {
		country_exists = QNG
	}

	option = {
		name = secondopiumwar.1.a
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		QNG = { country_event = { id = secondopiumwar.2 days = 1 } }
	}

	option = {
		name = secondopiumwar.1.b
		ai_chance = { factor = 95 }
		ENG = { country_event = { id = secondopiumwar.5 days = 1 } }
	}

	option = {
		name = secondopiumwar.1.c
		ai_chance = { factor = 0 }
		reverse_add_opinion_modifier = { target = QNG modifier = eoanb_om_FRA_QNG_ignored_chapdelaine }
		add_stability = -0.1
		add_political_power = -25
	}
}

# QNG gets demands for reparations from FRA
country_event = {
	id = secondopiumwar.2
	title = secondopiumwar.2.t
	desc = secondopiumwar.2.d
	picture = GFX_report_event_generic_sign_treaty2

	is_triggered_only = yes

	option = {
		name = secondopiumwar.2.a
		ai_chance = {
			factor = 0
		}
		add_political_power = -120
		FRA = { country_event = { id = secondopiumwar.3 days = 1 } }
	}

	option = {
		name = secondopiumwar.2.b
		ai_chance = { factor = 1 }
		FRA = { country_event = { id = secondopiumwar.4 days = 1 } }
	}

}

# FRA gets message QNG accepted
country_event = {
	id = secondopiumwar.3
	title = secondopiumwar.3.t
	desc = secondopiumwar.3.d
	picture = GFX_report_event_generic_sign_treaty2

	is_triggered_only = yes

	option = {
		name = secondopiumwar.3.a
		ai_chance = { factor = 100 }
		add_opinion_modifier = { target = QNG modifier = eoanb_om_FRA_QNG_gave_reparations }
		add_political_power = 120
	}
}

#FRA gets message QNG refused
country_event = {
	id = secondopiumwar.4
	title = secondopiumwar.4.t
	desc = secondopiumwar.4.d
	picture = GFX_report_event_generic_sign_treaty2

	is_triggered_only = yes

	option = {
		name = secondopiumwar.4.a
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		reverse_add_opinion_modifier = { target = QNG modifier = eoanb_om_FRA_QNG_ignored_chapdelaine }
		add_stability = -0.1
		add_political_power = -25
	}

	option = {
		name = secondopiumwar.4.b
		ai_chance = { factor = 95 }
		ENG = { country_event = { id = secondopiumwar.5 days = 1 } }
	}
}

#ENG gets request for coalition from FRA
country_event = {
	id = secondopiumwar.5
	title = secondopiumwar.5.t
	desc = secondopiumwar.5.d
	picture = GFX_GFX_report_event_generic_sign_treaty2

	is_triggered_only = yes

	option = {
		name = secondopiumwar.5.a
		ai_chance = { factor = 100 }
		FRA = { country_event = { id = secondopiumwar.6 days = 1 } }
	}

	option = {
		name = secondopiumwar.5.b
		ai_chance = { factor = 0 }
		FRA = { country_event = { id = secondopiumwar.7 days = 1 } }
	}
}

#FRA gets message ENG is cooperating
country_event = {
	id = secondopiumwar.6
	title = secondopiumwar.6.t
	desc = secondopiumwar.6.d
	picture = GFX_report_event_military_planning

	is_triggered_only = yes

	option = {
		name = secondopiumwar.6.a
		ai_chance = { factor = 100 }
		custom_effect_tooltip = eoanb_tt_sow_event_6_a
		hidden_effect = {
			set_global_flag = eoanb_flag_sow_ENG_FRA_cooperate
		}
	}
}

#FRA gets message ENG isn't cooperating
country_event = {
	id = secondopiumwar.7
	title = secondopiumwar.7.t
	desc = secondopiumwar.7.d
	picture = GFX_report_event_military_planning

	is_triggered_only = yes

	option = {
		name = secondopiumwar.7.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			set_global_flag = eoanb_flag_sow_ENG_FRA_cooperate_not
		}
	}
}

#QNG gets ultimatum by ENG
country_event = {
	id = secondopiumwar.8
	title = secondopiumwar.8.t
	desc = secondopiumwar.8.d
	picture = GFX_report_event_military_planning

	is_triggered_only = yes

	option = {
		name = secondopiumwar.8.a
		ai_chance = { factor = 95 }
		hidden_effect = {
			if = {
				limit = { has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate }
				FRA = { country_event = { id = secondopiumwar.10 days = 1 } }
			}
			ENG = {
				country_event = { id = secondopiumwar.10 days = 1 }
				set_country_flag = eoanb_flag_sow_ENG_can_assault_canton
			}
		}
	}

	option = {
		name = secondopiumwar.8.b
		ai_chance = {
			factor = 2
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		hidden_effect = {
			if = {
				limit = { has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate }
				FRA = { country_event = { id = secondopiumwar.9 days = 1 } }
			}
			ENG = {
				country_event = { id = secondopiumwar.9 days = 1 }
				set_country_flag = eoanb_flag_sow_ENG_yes_nanjing_treaty
			}
		}
	}
}

#Coalition Members are notified QNG accepted ultimatum
country_event = {
	id = secondopiumwar.9
	title = secondopiumwar.9.t
	desc = secondopiumwar.9.d

	picture = GFX_report_event_hungary_parliament
	is_triggered_only = yes

	option = {
		name = secondopiumwar.9.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = { tag = ENG }
		}
	}

	option = {
		name = secondopiumwar.9.b
		ai_chance = { factor = 100 }
		trigger = { tag = ENG }
	}

}

#Coalition Members are notified QNG rejected ultimatum
country_event = {
	id = secondopiumwar.10
	title = secondopiumwar.10.t
	desc = secondopiumwar.10.d
	picture = GFX_report_event_generic_sign_treaty1

	is_triggered_only = yes

	option = {
		name = secondopiumwar.10.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.10.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		custom_effect_tooltip = eoanb_tt_sow_event_10_b
	}

}

#Battle for Guangzhou starts
country_event = {
	id = secondopiumwar.11
	title = secondopiumwar.11.t
	desc = secondopiumwar.11.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.11.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_11
	}

	option = {
		name = secondopiumwar.11.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_11
	}

}

#EVENT 12 WAS PURGED

#QNG: Victory at Guangzhou
country_event = {
	id = secondopiumwar.13
	title = secondopiumwar.13.t
	desc = secondopiumwar.13.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.13.a
		ai_chance = { factor = 100 }
		custom_effect_tooltip = eoanb_tt_sow_event_decision_may_appear
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_won_at_canton }
		}
	}
}

#Coalition: Defeat at Guangzhou
country_event = {
	id = secondopiumwar.14
	title = secondopiumwar.14.t
	desc = secondopiumwar.14.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.14.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.14.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		custom_effect_tooltip = eoanb_tt_sow_event_decision_may_appear
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_lost_at_canton }
		}
	}

}

#QNG: Defeat at Guangzhou
country_event = {
	id = secondopiumwar.15
	title = secondopiumwar.15.t
	desc = secondopiumwar.15.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.15.a
		ai_chance = { factor = 100 }
		custom_effect_tooltip = eoanb_tt_sow_event_decision_may_appear
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_lost_at_canton }
		}
	}

}

#Coalition: Victory at Guangzhou
country_event = {
	id = secondopiumwar.16
	title = secondopiumwar.16.t
	desc = secondopiumwar.16.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.16.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.16.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		custom_effect_tooltip = eoanb_tt_sow_event_decision_may_appear
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_won_at_canton }
		}
	}

}

#Battle of Guangzhou ends in a draw
country_event = {
	id = secondopiumwar.17
	title = secondopiumwar.17.t
	desc = secondopiumwar.17.d
	picture = GFX_report_event_yugoslavian_cavalry

	is_triggered_only = yes

	option = {
		name = secondopiumwar.17.a
		ai_chance = { factor = 100 }
	}

}

#Battle for Taku Forts starts
country_event = {
	id = secondopiumwar.18
	title = secondopiumwar.18.t
	desc = secondopiumwar.18.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.18.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_18
	}

	option = {
		name = secondopiumwar.18.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_18
	}

}

#QNG: Victory at Taku Forts
country_event = {
	id = secondopiumwar.19
	title = secondopiumwar.19.t
	desc = secondopiumwar.19.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.19.a
		ai_chance = { factor = 100 }
		custom_effect_tooltip = eoanb_tt_sow_event_decision_may_appear
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_won_at_taku }
		}
	}
}

#Coalition: Defeat at Taku Forts
country_event = {
	id = secondopiumwar.20
	title = secondopiumwar.20.t
	desc = secondopiumwar.20.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.20.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.20.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_lost_at_taku }
		}
	}

}

#QNG: Defeat at Taku Forts
country_event = {
	id = secondopiumwar.21
	title = secondopiumwar.21.t
	desc = secondopiumwar.21.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.21.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_lost_at_taku }
		}
	}

}

#Coalition: Victory at Taku Forts
country_event = {
	id = secondopiumwar.22
	title = secondopiumwar.22.t
	desc = secondopiumwar.22.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.22.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.22.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		custom_effect_tooltip = eoanb_tt_sow_event_decision_may_appear
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_won_at_taku }
		}
	}

}

#Battle of Taku Forts ends in a draw
country_event = {
	id = secondopiumwar.23
	title = secondopiumwar.23.t
	desc = secondopiumwar.23.d
	picture = GFX_report_event_yugoslavian_cavalry

	is_triggered_only = yes

	option = {
		name = secondopiumwar.23.a
		ai_chance = { factor = 100 }
	}

}

#Second Battle of Guangzhou starts
country_event = {
	id = secondopiumwar.24
	title = secondopiumwar.24.t
	desc = secondopiumwar.24.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.24.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_24
	}

	option = {
		name = secondopiumwar.24.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_24
	}

}

#Second Battle of Guangzhou ends
country_event = {
	id = secondopiumwar.25
	title = secondopiumwar.25.t
	desc = secondopiumwar.25.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.25.a
		ai_chance = { factor = 100 }
	}

}

#QNG receives Treaty of Tianjin Demands
country_event = {
	id = secondopiumwar.26
	title = secondopiumwar.26.t
	desc = secondopiumwar.26.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	#QNG accepts
	option = {
		name = secondopiumwar.26.a
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		if = {
			limit = {
				has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate
			}
			ENG = { country_event = { id = secondopiumwar.27 days = 1 } }
			FRA = { country_event = { id = secondopiumwar.27 days = 1 } }
		}
		if = {
			limit = {
				has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate_not
			}
			ENG = { country_event = { id = secondopiumwar.27 days = 1 } }
		}
		if = {
			limit = {
				has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate
			}
			clr_global_flag = eoanb_flag_sow_ongoing
			QNG = { add_stability = -0.2 }
			QNG = { add_political_power = -250 }
			ENG = { add_political_power = 150 }
			FRA = { add_political_power = 150 }
			QNG = { add_opinion_modifier = { target = FRA modifier = eoanb_om_QNG_dislikes_winners_tianjin } }
			QNG = { add_opinion_modifier = { target = ENG modifier = eoanb_om_QNG_dislikes_winners_tianjin } }
			if = {
				limit = {
					USA = {
						#has_completed_focus = USA_trade_treaties
						has_country_flag = USA_tianjin_treaty_flag
					}
				}
				QNG = { add_opinion_modifier = { target = USA modifier = eoanb_om_QNG_dislikes_winners_tianjin } }
				USA = {
					add_timed_idea = {
						idea = USA_QNG_treaty_of_tianjin
						days = 3650
					}
				}
			}
			if = {
				limit = {
					QNG = { has_idea = free_trade }
				}
				add_political_power = 0
			}
			if = {
				limit = {
					QNG = { has_idea = export_focus }
				}
				swap_ideas = {
					remove_idea = export_focus
					add_idea = free_trade
				}
			}
			if = {
				limit = {
					QNG = { has_idea = limited_exports }
				}
				swap_ideas = {
					remove_idea = limited_exports
					add_idea = export_focus
				}
			}
			if = {
				limit = {
					QNG = { has_idea = closed_economy }
				}
				swap_ideas = {
					remove_idea = closed_economy
					add_idea = limited_exports
				}
			}
		}
		if = {
			limit = {
				has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate_not
			}
			clr_global_flag = eoanb_flag_sow_ongoing
			QNG = { add_stability = -0.2 }
			QNG = { add_political_power = -250 }
			ENG = { add_political_power = 150 }
			QNG = { add_opinion_modifier = { target = ENG modifier = eoanb_om_QNG_dislikes_winners_tianjin } }
			if = {
				limit = {
					QNG = { has_idea = free_trade }
				}
				add_political_power = 0
			}
			if = {
				limit = {
					QNG = { has_idea = export_focus }
				}
				swap_ideas = {
					remove_idea = export_focus
					add_idea = free_trade
				}
			}
			if = {
				limit = {
					QNG = { has_idea = limited_exports }
				}
				swap_ideas = {
					remove_idea = limited_exports
					add_idea = export_focus
				}
			}
			if = {
				limit = {
					QNG = { has_idea = closed_economy }
				}
				swap_ideas = {
					remove_idea = closed_economy
					add_idea = limited_exports
				}
			}
		}
		remove_ideas = QNG_idea_arrow_incident
		add_ideas = QNG_idea_sow_humiliation
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_yes_tianjin_treaty }
			clr_global_flag = eoanb_flag_sow_ongoing
		}
	}

	#QNG refuses
	option = {
		name = secondopiumwar.26.b
		ai_chance = { factor = 90 }
		if = {
			limit = {
				has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate
			}
			ENG = { country_event = { id = secondopiumwar.28 days = 1 } }
			FRA = { country_event = { id = secondopiumwar.28 days = 1 } }
		}
		if = {
			limit = {
				has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate_not
			}
			ENG = { country_event = { id = secondopiumwar.28 days = 1 } }
		}
		hidden_effect = {
			if = {
				limit = {
					has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate
				}
				clr_global_flag = eoanb_flag_sow_ENG_FRA_cooperate
				ENG = { set_country_flag = eoanb_flag_sow_coalition_member }
				FRA = { set_country_flag = eoanb_flag_sow_coalition_member }
			}
			if = {
				limit = {
					has_global_flag = eoanb_flag_sow_ENG_FRA_cooperate_not
				}
				clr_global_flag = eoanb_flag_sow_ENG_FRA_cooperate_not
				ENG = { set_country_flag = eoanb_flag_sow_coalition_member }
			}
			set_country_flag = eoanb_flag_sow_QNG_refused_tianjin_treaty
		}
	}

}

#Coalition Message: QNG accepted
country_event = {
	id = secondopiumwar.27
	title = secondopiumwar.27.t
	desc = secondopiumwar.27.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = secondopiumwar.27.a
		ai_chance = { factor = 100 }
	}

}

#Coalition Message: QNG refused
country_event = {
	id = secondopiumwar.28
	title = secondopiumwar.28.t
	desc = secondopiumwar.28.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = secondopiumwar.28.a
		ai_chance = { factor = 100 }
	}

}

#ENG receives request to join Coalition
country_event = {
	id = secondopiumwar.29
	title = secondopiumwar.29.t
	desc = secondopiumwar.29.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	#Accept
	option = {
		name = secondopiumwar.29.a
		ai_chance = { factor = 50 }
		if = {
			limit = {
				FROM = { TAG = USA }
			}
			USA = { country_event = { id = secondopiumwar.30 days = 1 } }
		}
		if = {
			limit = {
				FROM = { TAG = RUS }
			}
			RUS = { country_event = { id = secondopiumwar.30 days = 1 } }
		}
	}

	#Refuse
	option = {
		name = secondopiumwar.29.b
		ai_chance = { factor = 50 }
		if = {
			limit = {
				FROM = { TAG = USA }
			}
			USA = { country_event = { id = secondopiumwar.31 days = 1 } }
		}
		if = {
			limit = {
				FROM = { TAG = RUS }
			}
			RUS = { country_event = { id = secondopiumwar.31 days = 1 } }
		}
	}

}

#Coalition join approved
country_event = {
	id = secondopiumwar.30
	title = secondopiumwar.30.t
	desc = secondopiumwar.30.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = secondopiumwar.30.a
		ai_chance = { factor = 100 }
		custom_effect_tooltip = eoanb_tt_sow_event_30_a
		hidden_effect = {
			set_country_flag = eoanb_flag_sow_coalition_member
		}
	}

}

#Coalition join refused
country_event = {
	id = secondopiumwar.31
	title = secondopiumwar.31.t
	desc = secondopiumwar.31.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = secondopiumwar.31.a
		ai_chance = { factor = 100 }
	}

}

#QNG receives Treaty of Aigun Demands
country_event = {
	id = secondopiumwar.32
	title = secondopiumwar.32.t
	desc = secondopiumwar.32.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = secondopiumwar.32.a
		ai_chance = { factor = 70 }
		RUS = { country_event = { id = secondopiumwar.33 days = 1 } }
		RUS = { transfer_state = 561 }
		RUS = { transfer_state = 1244 }
		RUS = { transfer_state = 560 }
		RUS = { transfer_state = 1247 }
		RUS = { transfer_state = 657 }
		RUS = { transfer_state = 1373 }
		RUS = { transfer_state = 1375 }
		custom_effect_tooltip = eoanb_tt_sow_event_32_a
		hidden_effect = {
			561 = { remove_core_of = QNG }
			561 = { add_claim_by = QNG }
			1244 = { remove_core_of = QNG }
			1244 = { add_claim_by = QNG }
			560 = { remove_core_of = QNG }
			560 = { add_claim_by = QNG }
			1247 = { remove_core_of = QNG }
			1247 = { add_claim_by = QNG }
			657 = { remove_core_of = QNG }
			657 = { add_claim_by = QNG }
			1373 = { remove_core_of = QNG }
			1373 = { add_claim_by = QNG }
			1375 = { remove_core_of = QNG }
			1375 = { add_claim_by = QNG }
			RUS = { add_state_core = 561 }
			RUS = { add_state_core = 1244 }
			RUS = { add_state_core = 560 }
			RUS = { add_state_core = 1247 }
			RUS = { add_state_core = 657 }
			RUS = { add_state_core = 1373 }
			RUS = { add_state_core = 1375 }
		}
	}

	option = {
		name = secondopiumwar.32.b
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		RUS = { country_event = { id = secondopiumwar.34 days = 1 } }
		hidden_effect = {
			set_country_flag = eoanb_flag_sow_QNG_refused_aigun_treaty
		}
	}

}

#RUS gets message QNG accepted Aigun
country_event = {
	id = secondopiumwar.33
	title = secondopiumwar.33.t
	desc = secondopiumwar.33.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = secondopiumwar.33.a
		ai_chance = { factor = 100 }
	}

}

#RUS gets message QNG denied Aigun
country_event = {
	id = secondopiumwar.34
	title = secondopiumwar.34.t
	desc = secondopiumwar.34.d
	picture = GFX_report_event_generic_read_write

	is_triggered_only = yes

	option = {
		name = secondopiumwar.34.a
		ai_chance = { factor = 100 }
	}

}

#QNG wins Aigun War
country_event = {
	id = secondopiumwar.35
	title = secondopiumwar.35.t
	desc = secondopiumwar.35.d
	picture = GFX_report_event_generic_army

	fire_only_once = yes

	trigger = {
		TAG = QNG
		has_war_with = RUS
		has_global_flag = eoanb_flag_sow_RUS_QNG_aigun_war
		RUS = { surrender_progress > 0.2 }
		QNG = { surrender_progress < 0.1 }
		RUS = { owns_state = 655 }
	}

	option = {
		name = secondopiumwar.35.a
		ai_chance = { factor = 100 }
		white_peace = RUS
		transfer_state = 655
		add_state_core = 655
		hidden_effect = {
			clr_global_flag = eoanb_flag_sow_RUS_QNG_aigun_war
		}
	}

}

#RUS wins Aigun War
country_event = {
	id = secondopiumwar.36
	title = secondopiumwar.36.t
	desc = secondopiumwar.36.d
	picture = GFX_report_event_generic_army

	fire_only_once = yes

	trigger = {
		TAG = RUS
		has_war_with = QNG
		has_global_flag = eoanb_flag_sow_RUS_QNG_aigun_war
		QNG = { surrender_progress > 0.2 }
		RUS = { surrender_progress < 0.1 }
	}

	option = {
		name = secondopiumwar.36.a
		ai_chance = { factor = 100 }
		white_peace = QNG
		transfer_state = 561
		transfer_state = 1244
		transfer_state = 560
		transfer_state = 1247
		transfer_state = 657
		transfer_state = 1373
		transfer_state = 1375
		transfer_state = 408
		transfer_state = 409
		transfer_state = 329
		MON = { transfer_state = 330 }
		MON = { transfer_state = 1248 }
		if = {
			limit = {
				OR = {
					has_dlc = "Together for Victory"
					has_dlc = "Death or Dishonor"
					has_dlc = "Waking the Tiger"
				}
			}
			set_autonomy = {
				target = MON
				autonomous_state = autonomy_dominion
				freedom_level = 0.5
			}
		}
		if = {
			limit = {
				NOT = { OR = {
					has_dlc = "Together for Victory"
					has_dlc = "Death or Dishonor"
					has_dlc = "Waking the Tiger"
				} }
			}
			puppet = MON
		}
		hidden_effect = {
			clr_global_flag = eoanb_flag_sow_RUS_QNG_aigun_war
			561 = { remove_core_of = QNG }
			561 = { add_claim_by = QNG }
			1244 = { remove_core_of = QNG }
			1244 = { add_claim_by = QNG }
			560 = { remove_core_of = QNG }
			560 = { add_claim_by = QNG }
			1247 = { remove_core_of = QNG }
			1247 = { add_claim_by = QNG }
			657 = { remove_core_of = QNG }
			657 = { add_claim_by = QNG }
			1373 = { remove_core_of = QNG }
			1373 = { add_claim_by = QNG }
			1375 = { remove_core_of = QNG }
			1375 = { add_claim_by = QNG }
			408 = { remove_core_of = QNG }
			408 = { add_claim_by = QNG }
			409 = { remove_core_of = QNG }
			409 = { add_claim_by = QNG }
			329 = { remove_core_of = QNG }
			329 = { add_claim_by = QNG }
			330 = { remove_core_of = QNG }
			330 = { add_claim_by = QNG }
			1248 = { remove_core_of = QNG }
			1248 = { add_claim_by = QNG }
			RUS = { add_state_core = 561 }
			RUS = { add_state_core = 1244 }
			RUS = { add_state_core = 560 }
			RUS = { add_state_core = 1247 }
			RUS = { add_state_core = 657 }
			RUS = { add_state_core = 1373 }
			RUS = { add_state_core = 1375 }
			RUS = { add_state_core = 408 }
			RUS = { add_state_core = 409 }
			RUS = { add_state_core = 329 }
		}
	}

}

#USA: Our stance on the Tientsin Campaign
country_event = {
	id = secondopiumwar.37
	title = secondopiumwar.37.t
	desc = secondopiumwar.37.d

	is_triggered_only = yes

	#Support the Western coalition
	option = {
		name = secondopiumwar.37.a
		ai_chance = { factor = 90 }
		reverse_add_opinion_modifier = { target = ENG modifier = eoanb_om_USA_stance_tientsin_positive }
		reverse_add_opinion_modifier = { target = QNG modifier = eoanb_om_USA_stance_tientsin_negative }
	}

	#Support China
	option = {
		name = secondopiumwar.37.b
		ai_chance = { factor = 5 }
		reverse_add_opinion_modifier = { target = ENG modifier = eoanb_om_USA_stance_tientsin_negative }
		reverse_add_opinion_modifier = { target = QNG modifier = eoanb_om_USA_stance_tientsin_positive }
	}

	#Support noone
	option = {
		name = secondopiumwar.37.c
		ai_chance = { factor = 5 }
	}

}

#Second Battle for Taku Forts starts
country_event = {
	id = secondopiumwar.38
	title = secondopiumwar.38.t
	desc = secondopiumwar.38.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.38.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_18_2
	}

	option = {
		name = secondopiumwar.38.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_18_2
	}

}

#QNG: Victory at Taku Forts (Second)
country_event = {
	id = secondopiumwar.39
	title = secondopiumwar.39.t
	desc = secondopiumwar.39.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.39.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_won_at_taku_2 }
		}
	}
}

#Coalition: Defeat at Taku Forts (Second)
country_event = {
	id = secondopiumwar.40
	title = secondopiumwar.40.t
	desc = secondopiumwar.40.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.40.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.40.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_lost_at_taku_2 }
		}
	}

}

#QNG: Defeat at Taku Forts (Second)
country_event = {
	id = secondopiumwar.41
	title = secondopiumwar.41.t
	desc = secondopiumwar.41.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.41.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_lost_at_taku_2 }
		}
	}

}

#Coalition: Victory at Taku Forts (Second)
country_event = {
	id = secondopiumwar.42
	title = secondopiumwar.42.t
	desc = secondopiumwar.42.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.42.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.42.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_won_at_taku_2 }
		}
	}

}

#Second Battle of Taku Forts ends in a draw
country_event = {
	id = secondopiumwar.43
	title = secondopiumwar.43.t
	desc = secondopiumwar.43.d
	picture = GFX_report_event_yugoslavian_cavalry

	is_triggered_only = yes

	option = {
		name = secondopiumwar.43.a
		ai_chance = { factor = 100 }
	}

}

#Third Battle for Taku Forts starts
country_event = {
	id = secondopiumwar.44
	title = secondopiumwar.44.t
	desc = secondopiumwar.44.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.44.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_18_3
	}

	option = {
		name = secondopiumwar.44.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_18_3
	}

}

#QNG: Victory at Taku Forts (Third)
country_event = {
	id = secondopiumwar.45
	title = secondopiumwar.45.t
	desc = secondopiumwar.45.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.45.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_won_at_taku_3 }
		}
	}
}

#Coalition: Defeat at Taku Forts (Third)
country_event = {
	id = secondopiumwar.46
	title = secondopiumwar.46.t
	desc = secondopiumwar.46.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.46.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.46.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_lost_at_taku_3 }
		}
	}

}

#QNG: Defeat at Taku Forts (Third)
country_event = {
	id = secondopiumwar.47
	title = secondopiumwar.47.t
	desc = secondopiumwar.47.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.47.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_lost_at_taku_3 }
		}
	}

}

#Coalition: Victory at Taku Forts (Third)
country_event = {
	id = secondopiumwar.48
	title = secondopiumwar.48.t
	desc = secondopiumwar.48.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.48.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.48.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_won_at_taku_3 }
		}
	}

}

#Third Battle of Taku Forts ends in a draw
country_event = {
	id = secondopiumwar.49
	title = secondopiumwar.49.t
	desc = secondopiumwar.49.d
	picture = GFX_report_event_yugoslavian_cavalry

	is_triggered_only = yes

	option = {
		name = secondopiumwar.49.a
		ai_chance = { factor = 100 }
	}

}

#Battle for Beijing starts
country_event = {
	id = secondopiumwar.50
	title = secondopiumwar.50.t
	desc = secondopiumwar.50.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.50.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_18_4
	}

	option = {
		name = secondopiumwar.50.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_18_4
	}

}

#QNG: Victory at Beijing
country_event = {
	id = secondopiumwar.51
	title = secondopiumwar.51.t
	desc = secondopiumwar.51.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.51.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_won_at_beijing }
		}
	}
}

#Coalition: Defeat at Beijing
country_event = {
	id = secondopiumwar.52
	title = secondopiumwar.52.t
	desc = secondopiumwar.52.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.52.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.52.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_lost_at_beijing }
		}
	}

}

#QNG: Defeat at Beijing
country_event = {
	id = secondopiumwar.53
	title = secondopiumwar.53.t
	desc = secondopiumwar.53.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.53.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_lost_at_beijing }
		}
	}

}

#Coalition: Victory at Beijing
country_event = {
	id = secondopiumwar.54
	title = secondopiumwar.54.t
	desc = secondopiumwar.54.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.54.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.54.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		ENG = { country_event = { id = secondopiumwar.56 } }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_won_at_beijing }
		}
	}

}

#Battle of Beijing ends in a draw
country_event = {
	id = secondopiumwar.55
	title = secondopiumwar.55.t
	desc = secondopiumwar.55.d
	picture = GFX_report_event_yugoslavian_cavalry

	is_triggered_only = yes

	option = {
		name = secondopiumwar.55.a
		ai_chance = { factor = 100 }
	}

}

#The Fate of Peking
country_event = {
	id = secondopiumwar.56
	title = secondopiumwar.56.t
	desc = secondopiumwar.56.d

	is_triggered_only = yes

	#Burn the Summer Palace
	option = {
		name = secondopiumwar.56.a
		ai_chance = { factor = 70 }
		reverse_add_opinion_modifier = { target = QNG modifier = eoanb_om_ENG_burnt_summer_palace }
		608 = { damage_building = { type = infrastructure damage = 0.5 } }

	}

	#Burn the Forbidden City
	option = {
		name = secondopiumwar.56.b
		ai_chance = { factor = 15 }
		reverse_add_opinion_modifier = { target = QNG modifier = eoanb_om_ENG_burnt_forbidden_city }
		608 = { damage_building = { type = infrastructure damage = 1.5 } }
	}

	#Leave the city intact
	option = {
		name = secondopiumwar.56.c
		ai_chance = { factor = 15 }
	}

}

#QNG gets information and penalties from Peking treaty
country_event = {
	id = secondopiumwar.57
	title = secondopiumwar.57.t
	desc = secondopiumwar.57.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.57.a
		ai_chance = { factor = 100 }
		add_stability = -0.3
		add_political_power = -300
		remove_ideas = QNG_idea_arrow_incident
		add_ideas = QNG_idea_sow_humiliation
		if = {
			limit = {
				QNG = { has_idea = free_trade }
			}
			add_political_power = 0
		}
		if = {
			limit = {
				QNG = { has_idea = export_focus }
			}
			swap_ideas = {
				remove_idea = export_focus
				add_idea = free_trade
			}
		}
		if = {
			limit = {
				QNG = { has_idea = limited_exports }
			}
			swap_ideas = {
				remove_idea = limited_exports
				add_idea = export_focus
			}
		}
		if = {
			limit = {
				QNG = { has_idea = closed_economy }
			}
			swap_ideas = {
				remove_idea = closed_economy
				add_idea = limited_exports
			}
		}
	}

}

#Coalition members get information and rewards from Peking treaty
country_event = {
	id = secondopiumwar.58
	title = secondopiumwar.58.t
	desc = secondopiumwar.58.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.58.a
		ai_chance = { factor = 100 }
		add_political_power = 200
		reverse_add_opinion_modifier = { target = QNG modifier = eoanb_om_QNG_dislikes_winners_sow_peking }
		hidden_effect = {
			clr_country_flag = eoanb_flag_sow_coalition_member
		}
	}

}

#ENG event: Offer Shanghai land to USA in Peking treaty?
country_event = {
	id = secondopiumwar.59
	title = secondopiumwar.59.t
	desc = secondopiumwar.59.d

	is_triggered_only = yes

	#Yes
	option = {
		name = secondopiumwar.59.a
		ai_chance = { factor = 70 }
		USA = { country_event = { id = secondopiumwar.60 } }
		custom_effect_tooltip = eoanb_tt_sow_event_59_a
	}

	#No
	option = {
		name = secondopiumwar.59.b
		ai_chance = { factor = 30 }
	}

}

#USA gets Shanghai land offer
country_event = {
	id = secondopiumwar.60
	title = secondopiumwar.60.t
	desc = secondopiumwar.60.d

	is_triggered_only = yes

	#Accept
	option = {
		name = secondopiumwar.60.a
		ai_chance = { factor = 80 }
		transfer_state = 1165
		add_timed_idea = { idea = ENG_USA_idea_sow_payment days = 120 }
		ENG = { add_timed_idea = { idea = ENG_ENG_idea_sow_payment days = 120 } }

	}

	#Refuse
	option = {
		name = secondopiumwar.60.b
		ai_chance = { factor = 20 }
	}

}

#QNG gets RUS's Peking Treaty amendment demands
country_event = {
	id = secondopiumwar.61
	title = secondopiumwar.61.t
	desc = secondopiumwar.61.d

	is_triggered_only = yes

	#Accept
	option = {
		name = secondopiumwar.61.a
		ai_chance = { factor = 90 }
		RUS = { country_event = { id = secondopiumwar.62 days = 1 } }
		remove_state_claim = 655
	}

	#Refuse
	option = {
		name = secondopiumwar.61.b
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		RUS = { country_event = { id = secondopiumwar.63 days = 1 } }
	}

}

#RUS is notified QNG accepted
country_event = {
	id = secondopiumwar.62
	title = secondopiumwar.62.t
	desc = secondopiumwar.62.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.62.a
		ai_chance = { factor = 100 }
		if = {
			limit = {
				NOT = { RUS = { owns_state = 408 } }
			}
			transfer_state = 408
		}
		if = {
			limit = {
				NOT = { RUS = { owns_state = 409 } }
			}
			transfer_state = 409
		}
		hidden_effect = {
			408 = { remove_core_of = QNG }
			408 = { add_claim_by = QNG }
			409 = { remove_core_of = QNG }
			409 = { add_claim_by = QNG }
			RUS = { add_state_core = 408 }
			RUS = { add_state_core = 409 }
		}
	}

}

#RUS is notified QNG refused
country_event = {
	id = secondopiumwar.63
	title = secondopiumwar.63.t
	desc = secondopiumwar.63.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.63.a
		ai_chance = { factor = 100 }
		custom_effect_tooltip = eoanb_tt_sow_event_63_a
		hidden_effect = {
			set_country_flag = eoanb_flag_sow_RUS_QNG_peking_amendment_war_possible
		}
	}

}

#QNG wins Peking War
country_event = {
	id = secondopiumwar.64
	title = secondopiumwar.64.t
	desc = secondopiumwar.64.d
	picture = GFX_report_event_generic_army

	fire_only_once = yes

	trigger = {
		TAG = QNG
		has_war_with = RUS
		has_global_flag = eoanb_flag_sow_RUS_QNG_peking_war
		RUS = { surrender_progress > 0.2 }
		QNG = { surrender_progress < 0.1 }
		RUS = { owns_state = 655 }
	}

	option = {
		name = secondopiumwar.64.a
		ai_chance = { factor = 100 }
		white_peace = RUS
		transfer_state = 655
		add_state_core = 655
		hidden_effect = {
			clr_global_flag = eoanb_flag_sow_RUS_QNG_peking_war
		}
	}

}

#RUS wins Peking War
country_event = {
	id = secondopiumwar.65
	title = secondopiumwar.65.t
	desc = secondopiumwar.65.d
	picture = GFX_report_event_generic_army

	fire_only_once = yes

	trigger = {
		TAG = RUS
		has_war_with = QNG
		has_global_flag = eoanb_flag_sow_RUS_QNG_peking_war
		QNG = { surrender_progress > 0.2 }
		RUS = { surrender_progress < 0.1 }
	}

	option = {
		name = secondopiumwar.65.a
		ai_chance = { factor = 100 }
		white_peace = QNG
		if = {
			limit = {
				NOT = { RUS = { owns_state = 408 } }
			}
			transfer_state = 408
		}
		if = {
			limit = {
				NOT = { RUS = { owns_state = 409 } }
			}
			transfer_state = 409
		}
		if = {
			limit = {
				NOT = { RUS = { owns_state = 329 } }
			}
			transfer_state = 329
		}
		MON = { transfer_state = 330 }
		if = {
			limit = {
				OR = {
					has_dlc = "Together for Victory"
					has_dlc = "Death or Dishonor"
					has_dlc = "Waking the Tiger"
				}
			}
			set_autonomy = {
				target = MON
				autonomous_state = autonomy_dominion
				freedom_level = 0.5
			}
		}
		if = {
			limit = {
				NOT = { OR = {
					has_dlc = "Together for Victory"
					has_dlc = "Death or Dishonor"
					has_dlc = "Waking the Tiger"
				} }
			}
			puppet = MON
		}
		hidden_effect = {
			clr_global_flag = eoanb_flag_sow_RUS_QNG_peking_war
			408 = { remove_core_of = QNG }
			408 = { add_claim_by = QNG }
			409 = { remove_core_of = QNG }
			409 = { add_claim_by = QNG }
			329 = { remove_core_of = QNG }
			329 = { add_claim_by = QNG }
			RUS = { add_state_core = 408 }
			RUS = { add_state_core = 409 }
			RUS = { add_state_core = 329 }
		}
	}

}

#QNG: Seize US Concessions in Shanghai?
country_event = {
	id = secondopiumwar.66
	title = secondopiumwar.66.t
	desc = secondopiumwar.66.d

	is_triggered_only = yes

	#Yes
	option = {
		name = secondopiumwar.66.a
		ai_chance = { factor = 60 }
		USA = { country_event = { id = secondopiumwar.68 } }
	}

	#No
	option = {
		name = secondopiumwar.66.b
		ai_chance = { factor = 40 }
		reverse_add_opinion_modifier = { target = USA modifier = eoanb_om_QNG_respected_USA_shanghai }
	}

}

#Coalition: Shanghai concessions seized
country_event = {
	id = secondopiumwar.67
	title = secondopiumwar.67.t
	desc = secondopiumwar.67.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.67.a
		ai_chance = { factor = 100 }
		custom_effect_tooltip = eoanb_tt_sow_event_67_a
	}

}

#USA: QNG seized US concessions in Shanghai
country_event = {
	id = secondopiumwar.68
	title = secondopiumwar.68.t
	desc = secondopiumwar.68.d

	is_triggered_only = yes

	#Send Ships
	option = {
		name = secondopiumwar.68.a
		ai_chance = { factor = 70 }
		custom_effect_tooltip = eoanb_tt_sow_event_decision_may_appear
		hidden_effect = {
			USA = { set_country_flag = eoanb_flag_sow_USA_send_warships }
		}
	}

	#We have bigger problems
	option = {
		name = secondopiumwar.68.b
		ai_chance = { factor = 30 }
		QNG = { country_event = { id = secondopiumwar.69 } }
	}

}

#QNG: US backs down over Shanghai
country_event = {
	id = secondopiumwar.69
	title = secondopiumwar.69.t
	desc = secondopiumwar.69.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.69.a
		ai_chance = { factor = 100 }
	}

}

#QNG: US gunboats near Shanghai
country_event = {
	id = secondopiumwar.70
	title = secondopiumwar.70.t
	desc = secondopiumwar.70.d

	is_triggered_only = yes

	#That's a lot of guns...
	option = {
		name = secondopiumwar.70.a
		ai_chance = { factor = 80 }
		USA = { country_event = { id = secondopiumwar.71 } }
		reverse_add_opinion_modifier = { target = USA modifier = eoanb_om_QNG_respected_USA_shanghai }
	}

	#We stand firm
	option = {
		name = secondopiumwar.70.b
		ai_chance = { factor = 20 }
		USA = { country_event = { id = secondopiumwar.72 } }
	}

}

#USA: QNG backs down over Shanghai
country_event = {
	id = secondopiumwar.71
	title = secondopiumwar.71.t
	desc = secondopiumwar.71.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.71.a
		ai_chance = { factor = 100 }
	}

}

#USA: QNG refuses to back down over Shanghai
country_event = {
	id = secondopiumwar.72
	title = secondopiumwar.72.t
	desc = secondopiumwar.72.d

	is_triggered_only = yes

	#Then they will learn by force - shell the city
	option = {
		name = secondopiumwar.72.a
		ai_chance = { factor = 50 }
		if = {
			limit = {
				NOT = { has_country_flag = eoanb_flag_sow_coalition_member }
			}
			ENG = { country_event = { id = secondopiumwar.73 } }
		}
		else = {
			custom_effect_tooltip = eoanb_tt_sow_event_72
		}
		hidden_effect = {
			news_event = { id = secondopiumwarnews.4 random = 6 }
		}
	}

	#Then they will learn by force - but we won't shell civilians
	option = {
		name = secondopiumwar.72.b
		ai_chance = { factor = 20 }
		if = {
			limit = {
				NOT = { has_country_flag = eoanb_flag_sow_coalition_member }
			}
			ENG = { country_event = { id = secondopiumwar.73 } }
		}
		else = {
			custom_effect_tooltip = eoanb_tt_sow_event_72
		}
	}

	#We can't afford a war
	option = {
		name = secondopiumwar.72.c
		ai_chance = { factor = 30 }
		QNG = { country_event = { id = secondopiumwar.69 } }
	}

}

#ENG: US wants to join coalition after Shanghai
country_event = {
	id = secondopiumwar.73
	title = secondopiumwar.73.t
	desc = secondopiumwar.73.d

	is_triggered_only = yes

	#They are welcome
	option = {
		name = secondopiumwar.73.a
		ai_chance = { factor = 85 }
		USA = { country_event = { id = secondopiumwar.74 } }
		hidden_effect = {
			USA = { set_country_flag = eoanb_flag_sow_coalition_member }
		}
	}

	#No thanks
	option = {
		name = secondopiumwar.73.b
		ai_chance = { factor = 15 }
		USA = { country_event = { id = secondopiumwar.75 } }
	}

}

#USA: ENG accepts coalition join request
country_event = {
	id = secondopiumwar.74
	title = secondopiumwar.74.t
	desc = secondopiumwar.74.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.74.a
		ai_chance = { factor = 100 }
	}

}

#USA: ENG refuses coalition join request
country_event = {
	id = secondopiumwar.75
	title = secondopiumwar.75.t
	desc = secondopiumwar.75.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.75.a
		ai_chance = { factor = 100 }
	}

}

#Battle for Shanghai starts
country_event = {
	id = secondopiumwar.76
	title = secondopiumwar.76.t
	desc = secondopiumwar.76.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.76.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_18_5
	}

	option = {
		name = secondopiumwar.76.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_18_5
	}

}

#QNG: Victory at Shanghai
country_event = {
	id = secondopiumwar.77
	title = secondopiumwar.77.t
	desc = secondopiumwar.77.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.77.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_won_at_shanghai }
		}
	}
}

#Coalition: Defeat at Shanghai
country_event = {
	id = secondopiumwar.78
	title = secondopiumwar.78.t
	desc = secondopiumwar.78.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.78.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.78.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_lost_at_shanghai }
		}
	}

}

#QNG: Defeat at Shanghai
country_event = {
	id = secondopiumwar.79
	title = secondopiumwar.79.t
	desc = secondopiumwar.79.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.79.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_lost_at_shanghai }
		}
	}

}

#Coalition: Victory at Shanghai
country_event = {
	id = secondopiumwar.80
	title = secondopiumwar.80.t
	desc = secondopiumwar.80.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.80.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.80.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_won_at_shanghai }
		}
	}

}

#Battle of Shanghai ends in a draw
country_event = {
	id = secondopiumwar.81
	title = secondopiumwar.81.t
	desc = secondopiumwar.81.d
	picture = GFX_report_event_yugoslavian_cavalry

	is_triggered_only = yes

	option = {
		name = secondopiumwar.81.a
		ai_chance = { factor = 100 }
	}

}

#QNG: Shell Zhoushan?
country_event = {
	id = secondopiumwar.82
	title = secondopiumwar.82.t
	desc = secondopiumwar.82.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.82.a
		ai_chance = { factor = 50 }
		1163 = { add_manpower = -1000 }
		hidden_effect = {
			news_event = { id = secondopiumwarnews.5 random = 6 }
		}
	}

	option = {
		name = secondopiumwar.82.b
		ai_chance = { factor = 50 }
	}

}

#Coalition: HK Ambush
country_event = {
	id = secondopiumwar.83
	title = secondopiumwar.83.t
	desc = secondopiumwar.83.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.83.a
		ai_chance = { factor = 100 }
	}

}

#ENG: Cut our losses?
country_event = {
	id = secondopiumwar.84
	title = secondopiumwar.84.t
	desc = secondopiumwar.84.d

	is_triggered_only = yes

	#Yes, invite QNG to a conference
	option = {
		name = secondopiumwar.84.a
		ai_chance = { factor = 30 }
		QNG = { country_event = { id = secondopiumwar.85 days = 1 } }
	}

	#No
	option = {
		name = secondopiumwar.84.b
		ai_chance = { factor = 70 }
		QNG = { country_event = { id = secondopiumwar.88 days = 1 } }
		custom_effect_tooltip = eoanb_tt_sow_event_88_leadup
		hidden_effect = {
			set_country_flag = eoanb_flag_sow_ENG_can_assault_kowloon
		}
	}

}

#QNG: HK Conference initiation
country_event = {
	id = secondopiumwar.85
	title = secondopiumwar.85.t
	desc = secondopiumwar.85.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.85.a
		ai_chance = { factor = 100 }
		ENG = { country_event = { id = secondopiumwar.86 days = 1 } }
	}

}

#ENG: HK Conference Treaty of Kowloon decision
country_event = {
	id = secondopiumwar.86
	title = secondopiumwar.86.t
	desc = secondopiumwar.86.d

	is_triggered_only = yes

	#Yes
	option = {
		name = secondopiumwar.86.a
		ai_chance = { factor = 60 }
		QNG = { country_event = { id = secondopiumwar.87 days = 1 } }
		add_political_power = -200
		add_stability = -0.1
		hidden_effect = {
			clr_global_flag = eoanb_flag_sow_ongoing
			clr_country_flag = eoanb_flag_sow_coalition_member
			every_country = {
				limit = {
					NOT = { TAG = ENG }
					has_country_flag = eoanb_flag_sow_coalition_member
				}
				clr_country_flag = eoanb_flag_sow_coalition_member
			}
			if = {
				limit = {
					NOT = { QNG = { owns_state = 1171 } }
				}
				QNG = { transfer_state = 1171 }
			}
			if = {
				limit = {
					NOT = { QNG = { owns_state = 1163 } }
				}
				QNG = { transfer_state = 1163 }
			}
			scripted_effect_clear_sow_flags = yes
			set_global_flag = eoanb_flag_sow_kowloon_treaty
		}
	}

	#No
	option = {
		name = secondopiumwar.86.b
		ai_chance = { factor = 40 }
		QNG = { country_event = { id = secondopiumwar.88 days = 1 } }
		custom_effect_tooltip = eoanb_tt_sow_event_88_leadup
		hidden_effect = {
			set_country_flag = eoanb_flag_sow_ENG_can_assault_kowloon
		}
	}

}

#QNG: Treaty of Kowloon accepted
country_event = {
	id = secondopiumwar.87
	title = secondopiumwar.87.t
	desc = secondopiumwar.87.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.87.a
		ai_chance = { factor = 100 }
		add_political_power = 200
		add_stability = 0.1
	}

}

#QNG: Treaty of Kowloon rejected
country_event = {
	id = secondopiumwar.88
	title = secondopiumwar.88.t
	desc = secondopiumwar.88.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.88.a
		ai_chance = { factor = 100 }
	}

}

#Battle for Kowloon starts
country_event = {
	id = secondopiumwar.89
	title = secondopiumwar.89.t
	desc = secondopiumwar.89.d
	picture = GFX_report_event_generic_army

	is_triggered_only = yes

	option = {
		name = secondopiumwar.89.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
		custom_effect_tooltip = eoanb_tt_sow_event_18_6
	}

	option = {
		name = secondopiumwar.89.b
		ai_chance = { factor = 100 }
		trigger = { TAG = QNG }
		custom_effect_tooltip = eoanb_tt_sow_event_18_6
	}

}

#QNG: Victory at Kowloon
country_event = {
	id = secondopiumwar.90
	title = secondopiumwar.90.t
	desc = secondopiumwar.90.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.90.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_won_at_kowloon }
		}
	}
}

#Coalition: Defeat at Kowloon
country_event = {
	id = secondopiumwar.91
	title = secondopiumwar.91.t
	desc = secondopiumwar.91.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.91.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.91.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		country_event = { id = secondopiumwar.95 days = 1 }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_lost_at_kowloon }
		}
	}

}

#QNG: Defeat at Kowloon
country_event = {
	id = secondopiumwar.92
	title = secondopiumwar.92.t
	desc = secondopiumwar.92.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.92.a
		ai_chance = { factor = 100 }
		hidden_effect = {
			QNG = { set_country_flag = eoanb_flag_sow_QNG_lost_at_kowloon }
		}
	}

}

#Coalition: Victory at Kowloon
country_event = {
	id = secondopiumwar.93
	title = secondopiumwar.93.t
	desc = secondopiumwar.93.d
	picture = GFX_report_event_ger_civil_war

	is_triggered_only = yes

	option = {
		name = secondopiumwar.93.a
		ai_chance = { factor = 100 }
		trigger = {
			NOT = {
				TAG = ENG
			}
		}
	}

	option = {
		name = secondopiumwar.93.b
		ai_chance = { factor = 100 }
		trigger = { TAG = ENG }
		country_event = { id = secondopiumwar.97 days = 1 }
		hidden_effect = {
			ENG = { set_country_flag = eoanb_flag_sow_ENG_won_at_kowloon }
		}
	}

}

#Battle of Kowloon ends in a draw
country_event = {
	id = secondopiumwar.94
	title = secondopiumwar.94.t
	desc = secondopiumwar.94.d
	picture = GFX_report_event_yugoslavian_cavalry

	is_triggered_only = yes

	option = {
		name = secondopiumwar.94.a
		ai_chance = { factor = 100 }
	}

}

#ENG is forced to cut losses
country_event = {
	id = secondopiumwar.95
	title = secondopiumwar.95.t
	desc = secondopiumwar.95.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.95.a
		ai_chance = { factor = 100 }
		QNG = { country_event = { id = secondopiumwar.96 days = 1 } }
		add_political_power = -250
		add_stability = -0.15
		custom_effect_tooltip = eoanb_tt_sow_event_95
		hidden_effect = {
			clr_global_flag = eoanb_flag_sow_ongoing
			clr_country_flag = eoanb_flag_sow_coalition_member
			every_country = {
				limit = {
					NOT = { TAG = ENG }
					has_country_flag = eoanb_flag_sow_coalition_member
				}
				clr_country_flag = eoanb_flag_sow_coalition_member
			}
			if = {
				limit = {
					NOT = { QNG = { owns_state = 1171 } }
				}
				QNG = { transfer_state = 1171 }
			}
			if = {
				limit = {
					NOT = { QNG = { owns_state = 1163 } }
				}
				QNG = { transfer_state = 1163 }
			}
			scripted_effect_clear_sow_flags = yes
			set_global_flag = eoanb_flag_sow_west_driven_out
		}
	}

}

#QNG: Western powers driven out
country_event = {
	id = secondopiumwar.96
	title = secondopiumwar.96.t
	desc = secondopiumwar.96.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.96.a
		ai_chance = { factor = 100 }
		add_political_power = 250
		add_stability = 0.15
		transfer_state = 326
	}

}

#SOW ends in a draw
country_event = {
	id = secondopiumwar.97
	title = secondopiumwar.97.t
	desc = secondopiumwar.97.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.97.a
		ai_chance = { factor = 100 }
		QNG = { country_event = { id = secondopiumwar.98 days = 1 } }
		hidden_effect = {
			clr_global_flag = eoanb_flag_sow_ongoing
			clr_country_flag = eoanb_flag_sow_coalition_member
			every_country = {
				limit = {
					NOT = { TAG = ENG }
					has_country_flag = eoanb_flag_sow_coalition_member
				}
				clr_country_flag = eoanb_flag_sow_coalition_member
			}
			if = {
				limit = {
					NOT = { QNG = { owns_state = 1171 } }
				}
				QNG = { transfer_state = 1171 }
			}
			if = {
				limit = {
					NOT = { QNG = { owns_state = 1163 } }
				}
				QNG = { transfer_state = 1163 }
			}
			scripted_effect_clear_sow_flags = yes
			set_global_flag = eoanb_flag_sow_draw
		}
	}

}

#QNG: SOW ends
country_event = {
	id = secondopiumwar.98
	title = secondopiumwar.98.t
	desc = secondopiumwar.98.d

	is_triggered_only = yes

	option = {
		name = secondopiumwar.98.a
		ai_chance = { factor = 100 }
	}

}

#TO BE ADDED LATER HERE: ALTERNATE TREATY OF AIGUN FOR RUS (IF QNG ACCEPTS ULTIMATUM)

### NEWS EVENTS BELOW ###

#QNG accepts ultimatum - Treaty of Nanjing is signed
news_event = {
	id = secondopiumwarnews.1
	title = secondopiumwarnews.1.t
	desc = secondopiumwarnews.1.d
	picture = GFX_news_event_generic_sign_treaty3

	major = yes

	is_triggered_only = yes

	option = {
		name = secondopiumwarnews.1.a
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
	}

	option = {
		name = secondopiumwarnews.1.b
		trigger = { TAG = QNG }
	}

}

#QNG accepts ultimatum - Treaty of Nanjing is signed - only ENG
news_event = {
	id = secondopiumwarnews.2
	title = secondopiumwarnews.2.t
	desc = secondopiumwarnews.2.d
	picture = GFX_news_event_generic_sign_treaty3

	major = yes

	is_triggered_only = yes

	option = {
		name = secondopiumwarnews.2.a
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
	}

	option = {
		name = secondopiumwarnews.2.b
		trigger = { TAG = QNG }
	}

}

#The Convention of Peking
news_event = {
	id = secondopiumwarnews.3
	title = secondopiumwarnews.3.t
	desc = secondopiumwarnews.3.d
	picture = GFX_news_event_generic_sign_treaty3

	major = yes

	is_triggered_only = yes

	option = {
		name = secondopiumwarnews.3.a
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
	}

	option = {
		name = secondopiumwarnews.3.b
		trigger = { TAG = QNG }
	}

}

#The shelling of Shanghai
news_event = {
	id = secondopiumwarnews.4
	title = secondopiumwarnews.4.t
	desc = secondopiumwarnews.4.d
	picture = GFX_news_event_generic_riot

	major = yes

	is_triggered_only = yes

	option = {
		name = secondopiumwarnews.4.a
		trigger = {
			NOT = {
				OR = {
					TAG = QNG
					TAG = USA
				}
			}
		}
	}

	option = {
		name = secondopiumwarnews.4.b
		trigger = { TAG = QNG }
	}

	option = {
		name = secondopiumwarnews.4.c
		trigger = { TAG = USA }
	}

}

#The shelling of Zhoushan
news_event = {
	id = secondopiumwarnews.5
	title = secondopiumwarnews.5.t
	desc = secondopiumwarnews.5.d
	picture = GFX_news_event_generic_riot

	major = yes

	is_triggered_only = yes

	option = {
		name = secondopiumwarnews.5.a
		trigger = {
			NOT = {
				TAG = QNG
			}
		}
	}

	option = {
		name = secondopiumwarnews.5.b
		trigger = { TAG = QNG }
	}
}