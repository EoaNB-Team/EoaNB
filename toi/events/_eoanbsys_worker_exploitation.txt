add_namespace = eoanb_worker_unrest

#eoanb_worker_unrest.1-20		Unrest Incidents
#eoanb_worker_unrest.21-40		Generic Resistance

##### Unrest Incidents (eoanb_worker_unrest.1-20) #####

country_event = {
	id = eoanb_worker_unrest.1
	hidden = yes
	is_triggered_only = yes
	immediate = {
		country_event = { id = eoanb_worker_unrest.2 random_days = 90 }
	}
}

country_event = {
	id = eoanb_worker_unrest.2
	hidden = yes
	is_triggered_only = yes
	immediate = {
		hidden_effect = { clr_country_flag = worker_exploitation_incident_mission_stop }
	}
}

state_event = {
	id = eoanb_worker_unrest.3
	is_triggered_only = yes
	timeout_days = 1
	hidden = yes
	
	trigger = {
		ROOT = {
			check_variable = { var = worker_exploitation_value value = 10 compare = greater_than_or_equals } 
			check_variable = { var = worker_organization_value value = 10 compare = greater_than_or_equals } 
		}
	}

	immediate = {
		ROOT = {
			OWNER = {
				random_list = {
					40 = { #Resistance/Intervention Mission
						set_country_flag = worker_resistance_in_state_mission_1_flag 
						modifier = { add = -10 ROOT = { check_variable = { var = worker_exploitation_value value = 15 compare = less_than } } }
						modifier = { factor = 0 has_country_flag = worker_resistance_in_state_mission_1_flag }
						modifier = { factor = 0 has_idea = afr_post_tribal }
						modifier = { factor = 0 has_variable = has_afr_empire_mechanic_system }
					}
					30 = { #Politics Related Events
						set_country_flag = worker_exploitation_vote_discrimination_event_1_flag 
						modifier = { factor = 0 has_country_flag = worker_exploitation_vote_discrimination_event_1_flag }
						modifier = { factor = 0 NOT = { OR = { has_idea = parliamentary_suffrage has_idea = property_owners_suffrage } } }
						modifier = { factor = 0 has_idea = afr_post_tribal }
						modifier = { factor = 0 has_variable = has_afr_empire_mechanic_system }
					}
					20 = { #State Unique Events 
						set_country_flag = worker_exploitation_state_unique_event_1_flag
						modifier = { factor = 0 has_country_flag = worker_exploitation_state_unique_event_1_flag }
						modifier = { factor = 0 has_idea = afr_post_tribal }
						modifier = { factor = 0 has_variable = has_afr_empire_mechanic_system }
					} 
					10 = { #Nothing Happens
						clr_country_flag = worker_resistance_in_state_mission_1_flag
						clr_country_flag = worker_exploitation_vote_discrimination_event_1_flag
						clr_country_flag = worker_exploitation_state_unique_event_1_flag
						set_country_flag = worker_exploitation_random_event_none_flag
					}
				}
			}
		}
	}
	option = {
		OWNER = {
			#############################
			#  Politics Related Events  #
			#############################
			if = {
				limit = {
					has_country_flag = worker_resistance_in_state_mission_1_flag
				}
				clr_country_flag = worker_resistance_in_state_mission_1_flag
				ROOT = { 
					set_state_flag = worker_exploitation_resistance_in_state_flag 
					custom_effect_tooltip = worker_exploitation_resistance_in_state
				}
				#You dont add events for missions here
			}
			#############################
			#  Politics Related Events  #
			#############################
			else_if = {
				limit = {
					has_country_flag = worker_exploitation_vote_discrimination_event_1_flag
					NOT = {
						has_idea = absolutism
						has_idea = full_equality
					}
				}
				clr_country_flag = worker_exploitation_vote_discrimination_event_1_flag
				#Add your event to the list below
				random_list = {
					100 = { country_event = { id = eoanb_worker_unrest.4 random_days = 7 } }
				}
			}
			#########################
			#  State Unique Events  #
			#########################
			#Add a new else_if condition block below for state unique events
			#else_if = {
			#	limit = {
			#		has_country_flag = worker_exploitation_state_unique_event_1_flag
			#		ROOT = { has_state_flag = spain_hispaniola_persecute_protestants_flag }
			#	}
			#	clr_country_flag = worker_exploitation_state_unique_event_1_flag
			#	country_event = { id = spain_hispaniola_persecute_protestants.2 }
			#}
			########
			# None #
			########
			else_if = {
				limit = { has_country_flag = worker_exploitation_random_event_none_flag }
				clr_country_flag = worker_exploitation_random_event_none_flag
			}
			#If conditions are not met, the list re-rolls
			else = {
				ROOT = { state_event = { id = eoanb_worker_unrest.3 } }
			}
		}
	}
}

country_event = {
	id = eoanb_worker_unrest.4
	title = eoanb_worker_unrest.4.t
	picture = GFX_ITA_Crowd_Gathers
	is_triggered_only = yes
	
	desc = {
		text = eoanb_worker_unrest.4.d
	}
	
	option = {
		name = eoanb_worker_unrest.4.a
		trigger = { always = yes }
		ai_chance = { 
			base = 40 
			modifier = {
				add = 40
				has_political_power > 49
			}
		}
		custom_effect_tooltip = worker_incident_outcome_tooltip
		hidden_effect = { 
			random_list = {
				70 = { set_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_d }
				30 = { set_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_e }
			}
			country_event = { id = eoanb_worker_unrest.5 days = 7 } 
		}
		worker_event_clear_state_id_effect = yes
	}
	
	option = {
		name = eoanb_worker_unrest.4.b
		trigger = { command_power > 49 }
		ai_chance = { 
			base = 60 
			modifier = {
				add = -40
				has_political_power > 49
			}
		}
		add_command_power = -50
		custom_effect_tooltip = worker_incident_outcome_tooltip
		hidden_effect = {
			set_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_f
			country_event = { id = eoanb_worker_unrest.5 days = 7 }
		}
		worker_event_clear_state_id_effect = yes
	}
	
	option = {
		name = eoanb_worker_unrest.4.c
		trigger = { has_political_power > 0 }
		ai_chance = { base = 100 }
		add_political_power = -50
		custom_effect_tooltip = worker_incident_outcome_tooltip
		hidden_effect = {
			random_list = {
				30 = { set_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_f }
				70 = { set_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_g }
			}
			country_event = { id = eoanb_worker_unrest.5 days = 7 }
		}
		worker_event_clear_state_id_effect = yes
	}
}

country_event = {
	id = eoanb_worker_unrest.5
	title = eoanb_worker_unrest.5.t
	#picture = GFX_Muhammad
	is_triggered_only = yes
	desc = {
		text = eoanb_worker_unrest.5.d
		trigger = { has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_d }
	}
	desc = {
		text = eoanb_worker_unrest.5.e
		trigger = { has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_e }
	}
	desc = {
		text = eoanb_worker_unrest.5.f
		trigger = { has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_f }
	}
	desc = {
		text = eoanb_worker_unrest.5.g
		trigger = { has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_g }
	}
	
	option = {
		name = eoanb_worker_unrest.5.a
		trigger = { has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_d }
		clr_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_d
	}
	option = {
		name = eoanb_worker_unrest.5.b
		trigger = { 
			OR = {
				has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_e
				has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_f 
			}
		}
		clr_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_e
		clr_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_f
	}
	option = {
		name = eoanb_worker_unrest.5.c
		trigger = { has_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_g }
		clr_country_flag = worker_unrest_generic_vote_discrimination_event_1_2_g
		#add_timed_idea = { idea = worker_unrest_push_universal_suffrage_idea days = 75 } 
	}
}

##### Generic Resistance (eoanb_worker_unrest.21-40) #####

state_event = {
	id = eoanb_worker_unrest.21
	is_triggered_only = yes
	hidden = yes
	
	immediate = {
		if = {
			limit = { has_state_flag = worker_resistance_mission_outcome_timeout_flag }
			clr_state_flag = worker_resistance_mission_outcome_timeout_flag
			#############################
			###State Unique Resistance###
			#############################
			##Dominican Republic 1860's##
			#if = {
			#
			#}
			#else = {
				OWNER = {
					random_list = {
						20 = {
							country_event = { id = eoanb_worker_unrest.4 random_days = 7 }
							modifier = { factor = 0 OR = { has_idea = absolutism has_idea = universal_suffrage } }
							modifier = { factor = 0 has_idea = afr_post_tribal }
							modifier = { factor = 0 has_variable = has_afr_empire_mechanic_system }
						}
					}
				}
			#}
		}
		else_if = {
			limit = { has_state_flag = worker_resistance_mission_outcome_comeplete_flag }
			clr_state_flag = worker_resistance_mission_outcome_comeplete_flag
			#############################
			###State Unique Resistance###
			#############################
			##Dominican Republic 1860's##
			#if = {
			#	
			#}
			#else = {
				random_list = {
					80 = { 
						OWNER = { country_event = { id = eoanb_worker_unrest.23 } }
					}
					20 = { 
						OWNER = { country_event = { id = eoanb_worker_unrest.24 } }
						modifier = {
							factor = 0 
							OWNER = { check_variable = { PREV.worker_resistance_politics_party_allowed@THIS = 1 } }
						}
						modifier = {
							factor = 0 
							OWNER = { OR = { has_idea = absolute_monarchy has_idea = chiefdom } }
						}
					}
				}
			#}
		}
	}
}

country_event = {
	id = eoanb_worker_unrest.22
	title = eoanb_worker_unrest.22.t
	#picture = GFX_Muhammad
	is_triggered_only = yes
	desc = {
		text = eoanb_worker_unrest.22.desc
	}
	
	immediate = {
		#FROM = { 
		#	random_list = {
		#		34 = { set_state_flag = worker_resistance_mission_outcome_failed_1 }
		#		33 = { set_state_flag = worker_resistance_mission_outcome_failed_2 }
		#		33 = { set_state_flag = worker_resistance_mission_outcome_failed_3 }
		#	}
		#}
	}
	
	option = {
		name = eoanb_worker_unrest.22.a
		FROM = {
			if = {
				limit = {
					has_state_flag = worker_resistance_mission_outcome_failed_1 
				}
				damage_building = {
					type = infrastructure
					damage = 1
				}
			}
			else_if = {
				limit = {
					has_state_flag = worker_resistance_mission_outcome_failed_2 
				}
				damage_building = {
					type = infrastructure
					damage = 2
				}
			}
			else_if = {
				limit = {
					has_state_flag = worker_resistance_mission_outcome_failed_3 
				}
				damage_building = {
					type = infrastructure
					damage = 3
				}
			}
			hidden_effect = {
				if = {
					limit = { has_state_flag = worker_resistance_mission_outcome_failed_1 }
					clr_state_flag = worker_resistance_mission_outcome_failed_1
				}
				else_if = {
					limit = { has_state_flag = worker_resistance_mission_outcome_failed_2 }
					clr_state_flag = worker_resistance_mission_outcome_failed_2
				}
				else_if = {
					limit = { has_state_flag = worker_resistance_mission_outcome_failed_3 }
					clr_state_flag = worker_resistance_mission_outcome_failed_3
				}
			}
		}
	}
}

country_event = {
	id = eoanb_worker_unrest.23
	title = eoanb_worker_unrest.23.t
	#picture = GFX_Muhammad
	is_triggered_only = yes
	desc = {
		text = eoanb_worker_unrest.23.desc_1
		trigger = { NOT = { has_idea = foa_free_assembly } }
	}
	desc = {
		text = eoanb_worker_unrest.23.desc_2
		trigger = { has_idea = foa_free_assembly }
	}
	
	option = {
		name = eoanb_worker_unrest.23.a
		#FROM = { worker_organization_increase_by_10 = yes }
		custom_effect_tooltip = worker_resistance_generic_refund_command_power
		add_command_power = 50
	}
	
	option = {
		name = eoanb_worker_unrest.23.b
		trigger = { NOT = { has_idea = foa_free_assembly } }
		#FROM = { worker_organization_decrease_by_10 = yes }
	}
	
	option = {
		name = eoanb_worker_unrest.23.c
		trigger = { has_political_power > 0 }
		add_political_power = -50
		#FROM = { worker_organization_increase_by_10 = yes }
	}
}

country_event = {
	id = eoanb_worker_unrest.24
	title = eoanb_worker_unrest.24.t
	#picture = GFX_Muhammad
	is_triggered_only = yes
	desc = {
		text = eoanb_worker_unrest.24.desc_1
		trigger = { NOT = { has_idea = pp_open_politics } }
	}
	desc = {
		text = eoanb_worker_unrest.24.desc_2
		trigger = { has_idea = pp_open_politics }
	}
	
	option = {
		name = eoanb_worker_unrest.24.a
		set_variable = { FROM.worker_resistance_politics_party_allowed@ROOT = 1 }
		#FROM = { worker_organization_increase_by_10 = yes }
		custom_effect_tooltip = worker_resistance_generic_refund_command_power
		add_command_power = 50
	}
	
	option = {
		name = eoanb_worker_unrest.24.b
		trigger = { NOT = { has_idea = pp_open_politics } }
		#FROM = { worker_organization_decrease_by_5 = yes }
	}
	
	option = {
		name = eoanb_worker_unrest.24.c
		trigger = { has_political_power > 0 }
		add_political_power = -100
		#FROM = { worker_organization_increase_by_25 = yes }
		custom_effect_tooltip = worker_resistance_generic_refund_command_power
		add_command_power = 50
		set_variable = { FROM.worker_resistance_politics_party_allowed@ROOT = 1 }
	}
}
