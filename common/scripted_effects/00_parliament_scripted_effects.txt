enact_voted_reform = {
	### CULTURE
	# RELIGION
	if = {
		limit = { check_variable = { current_reform_id = 1.1 compare = equals } }
		add_ideas = atheistic_state
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 1.2 compare = equals } }
		add_ideas = secular_state
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 1.3 compare = equals } }
		add_ideas = state_religion
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 1.4 compare = equals } }
		add_ideas = theocratic_state
	}

	# EDUCATION
	else_if = {
		limit = { check_variable = { current_reform_id = 2.1 compare = equals } }
		add_ideas = oral_tradition
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 2.2 compare = equals } }
		add_ideas = privileged_education
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 2.3 compare = equals } }
		add_ideas = open_schools
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 2.4 compare = equals } }
		add_ideas = compulsory_education
	}

	# PRESS
	else_if = {
		limit = { check_variable = { current_reform_id = 3.1 compare = equals } }
		add_ideas = state_controlled_press
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 3.2 compare = equals } }
		add_ideas = censored_press
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 3.3 compare = equals } }
		add_ideas = free_press
	}

	# FREEDOM OF ASSEMBLY
	else_if = {
		limit = { check_variable = { current_reform_id = 4.1 compare = equals } }
		add_ideas = foa_banned
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 4.2 compare = equals } }
		add_ideas = foa_state_only
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 4.3 compare = equals } }
		add_ideas = foa_restricted_attendance
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 4.4 compare = equals } }
		add_ideas = foa_non_socialist
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 4.5 compare = equals } }
		add_ideas = foa_free_assembly
	}

	# TRADE UNIONS
	else_if = {
		limit = { check_variable = { current_reform_id = 5.1 compare = equals } }
		add_ideas = tu_prohibited
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 5.2 compare = equals } }
		add_ideas = tu_state_controlled
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 5.3 compare = equals } }
		add_ideas = tu_non_political
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 5.4 compare = equals } }
		add_ideas = tu_free_unions
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 5.5 compare = equals } }
		add_ideas = tu_general_comitee
	}

	# COURT
	else_if = {
		limit = { check_variable = { current_reform_id = 6.1 compare = equals } }
		add_ideas = kangaroo_court
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 6.2 compare = equals } }
		add_ideas = biased_courtroom
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 6.3 compare = equals } }
		add_ideas = high_judge_courtroom
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 6.4 compare = equals } }
		add_ideas = quasi_jury_court
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 6.5 compare = equals } }
		add_ideas = jury_court
	}

	### ECONOMY
	# TRADE LAWS
	else_if = {
		limit = { check_variable = { current_reform_id = 7.1 compare = equals } }
		add_ideas = free_trade
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 7.2 compare = equals } }
		add_ideas = export_focus
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 7.3 compare = equals } }
		add_ideas = limited_exports
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 7.4 compare = equals } }
		add_ideas = closed_economy
	}

	# TAX RATES
	else_if = {
		limit = { check_variable = { current_reform_id = 8.1 compare = equals } }
		add_ideas = taxation_level_5
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 8.2 compare = equals } }
		add_ideas = taxation_level_4
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 8.3 compare = equals } }
		add_ideas = taxation_level_3
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 8.4 compare = equals } }
		add_ideas = taxation_level_2
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 8.5 compare = equals } }
		add_ideas = taxation_level_1
	}

	# CHILD LABOUR
	else_if = {
		limit = { check_variable = { current_reform_id = 9.1 compare = equals } }
		add_ideas = cl_legal
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 9.2 compare = equals } }
		add_ideas = cl_restricted
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 9.3 compare = equals } }
		add_ideas = cl_illegal
	}

	# MILITARY SPENDING
	else_if = {
		limit = { check_variable = { current_reform_id = 12.1 compare = equals } }
		add_ideas = army_spending_level_5
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 12.2 compare = equals } }
		add_ideas = army_spending_level_4
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 12.3 compare = equals } }
		add_ideas = army_spending_level_3
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 12.4 compare = equals } }
		add_ideas = army_spending_level_2
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 12.5 compare = equals } }
		add_ideas = army_spending_level_1
	}

	### POPULATION
	# BORDER LAWS
	else_if = {
		limit = { check_variable = { current_reform_id = 14.1 compare = equals } }
		add_ideas = closed_borders
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 14.2 compare = equals } }
		add_ideas = border_control
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 14.3 compare = equals } }
		add_ideas = open_borders
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 14.4 compare = equals } }
		add_ideas = no_borders
	}

	# DISCRIMINATORY LAWS
	else_if = {
		limit = { check_variable = { current_reform_id = 15.1 compare = equals } }
		add_ideas = tribal_slavery
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 15.2 compare = equals } }
		add_ideas = slavery
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 15.3 compare = equals } }
		add_ideas = slavery_all_but_name
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 15.4 compare = equals } }
		add_ideas = racial_laws
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 15.5 compare = equals } }
		add_ideas = segregation
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 15.6 compare = equals } }
		add_ideas = limited_equality
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 15.7 compare = equals } }
		add_ideas = full_equality
	}

	# MOBILIZATION LAWS
	else_if = {
		limit = { check_variable = { current_reform_id = 16.1 compare = equals } }
		add_ideas = disarmed_nation
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 16.2 compare = equals } }
		add_ideas = volunteer_only
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 16.3 compare = equals } }
		add_ideas = limited_conscription
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 16.4 compare = equals } }
		add_ideas = extensive_conscription
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 16.5 compare = equals } }
		add_ideas = service_by_requirement
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 16.6 compare = equals } }
		add_ideas = all_adults_serve
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 16.7 compare = equals } }
		add_ideas = scraping_the_barrel
	}

	# SUFFRAGE
	else_if = {
		limit = { check_variable = { current_reform_id = 17.1 compare = equals } }
		add_ideas = absolutism
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 17.2 compare = equals } }
		add_ideas = parliamentary_suffrage
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 17.3 compare = equals } }
		add_ideas = property_owners_suffrage
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 17.4 compare = equals } }
		add_ideas = universal_male_suffrage
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 17.5 compare = equals } }
		add_ideas = universal_suffrage
	}

	# POLITICAL PARTIES
	else_if = {
		limit = { check_variable = { current_reform_id = 18.1 compare = equals } }
		add_ideas = pp_open_politics
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 18.2 compare = equals } }
		add_ideas = pp_ban_extremist_parties
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 18.3 compare = equals } }
		add_ideas = pp_limited_party_freedom
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 18.4 compare = equals } }
		add_ideas = pp_underground_parties
	}

	### INTERNAL BUDGET
	# HEALTHCARE
	else_if = {
		limit = { check_variable = { current_reform_id = 19.1 compare = equals } }
		add_ideas = social_spending_level_1
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 19.2 compare = equals } }
		add_ideas = social_spending_level_2
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 19.3 compare = equals } }
		add_ideas = social_spending_level_3
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 19.4 compare = equals } }
		add_ideas = social_spending_level_4
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 19.5 compare = equals } }
		add_ideas = social_spending_level_5
	}

	# LAW AND ORDER
	else_if = {
		limit = { check_variable = { current_reform_id = 20.1 compare = equals } }
		add_ideas = social_spending_level_1
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 20.2 compare = equals } }
		add_ideas = law_spending_level_2
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 20.3 compare = equals } }
		add_ideas = law_spending_level_3
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 20.4 compare = equals } }
		add_ideas = law_spending_level_4
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 20.5 compare = equals } }
		add_ideas = law_spending_level_5
	}

	# ROAD MAINTENANCE
	else_if = {
		limit = { check_variable = { current_reform_id = 21.1 compare = equals } }
		add_ideas = road_spending_level_1
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 21.2 compare = equals } }
		add_ideas = road_spending_level_2
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 21.3 compare = equals } }
		add_ideas = road_spending_level_3
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 21.4 compare = equals } }
		add_ideas = road_spending_level_4
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 21.5 compare = equals } }
		add_ideas = road_spending_level_5
	}

	# NAVAL INFRASTRUCTURE
	else_if = {
		limit = { check_variable = { current_reform_id = 22.1 compare = equals } }
		add_ideas = navy_spending_level_1
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 22.2 compare = equals } }
		add_ideas = navy_spending_level_2
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 22.3 compare = equals } }
		add_ideas = navy_spending_level_3
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 22.4 compare = equals } }
		add_ideas = navy_spending_level_4
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 22.5 compare = equals } }
		add_ideas = navy_spending_level_5
	}

	# ECONOMIC MOBILIZATION
	else_if = {
		limit = { check_variable = { current_reform_id = 23.1 compare = equals } }
		add_ideas = undisturbed_isolation
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 23.2 compare = equals } }
		add_ideas = isolation
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 23.3 compare = equals } }
		add_ideas = civilian_economy
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 23.4 compare = equals } }
		add_ideas = low_economic_mobilisation
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 23.5 compare = equals } }
		add_ideas = partial_economic_mobilisation
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 23.6 compare = equals } }
		add_ideas = war_economy
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 23.7 compare = equals } }
		add_ideas = tot_economic_mobilisation
	}

	# SCIENTIFIC FUNDING
	else_if = {
		limit = { check_variable = { current_reform_id = 24.1 compare = equals } }
		add_ideas = research_spending_level_1
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 24.2 compare = equals } }
		add_ideas = research_spending_level_2
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 24.3 compare = equals } }
		add_ideas = research_spending_level_3
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 24.4 compare = equals } }
		add_ideas = research_spending_level_4
	}

	### SPECIAL COUNTRY REFORMS
	# PRUSSIAN PARLIAMENT
	else_if = {
		limit = { check_variable = { current_reform_id = 25.1 compare = equals } }
		PRS = {
			remove_ideas = PRS_idea_three_class_franchise
			if = {
				limit = { has_idea = absolutism }
				swap_ideas = { remove_idea = absolutism add_idea = parliamentary_suffrage }
			}
			else_if = {
				limit = { has_idea = property_owners_suffrage }
				swap_ideas = { remove_idea = property_owners_suffrage add_idea = parliamentary_suffrage }
			}
			else_if = {
				limit = { has_idea = parliamentary_suffrage }
				swap_ideas = { remove_idea = parliamentary_suffrage add_idea = universal_male_suffrage }
			}
		}
		hidden_effect = {
			if = {
				limit = { has_active_mission = PRS_mission_liberalize_prussia }
				clr_country_flag = PRS_liberalization_in_progress_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 25.2 compare = equals } }
		PRS = {
			add_stability = 0.05
			swap_ideas = { remove_idea = PRS_idea_british_style_rule add_idea = PRS_idea_british_style_rule_2 }
		}
		hidden_effect = {
			if = {
				limit = { has_active_mission = PRS_mission_liberalize_prussia }
				clr_country_flag = PRS_liberalization_in_progress_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 25.3 compare = equals } }
		PRS = { add_ideas = PRS_idea_rule_of_law }
		hidden_effect = {
			if = {
				limit = { has_active_mission = PRS_mission_liberalize_prussia }
				clr_country_flag = PRS_liberalization_in_progress_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 25.4 compare = equals } }
		ENG = { country_event = { days = 1 id = prussia.846 } }
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 25.5 compare = equals } }
		PRS = {
			if = {
				limit = { has_idea = limited_exports }
				swap_ideas = { remove_idea = limited_exports add_idea = free_trade }
			}
			else_if = {
				limit = { has_idea = export_focus }
				swap_ideas = { remove_idea = export_focus add_idea = free_trade }
			}
		}
		hidden_effect = {
			if = {
				limit = { has_active_mission = PRS_mission_liberalize_prussia }
				clr_country_flag = PRS_liberalization_in_progress_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 25.6 compare = equals } }
		PRS = { 
			add_stability = 0.05
			swap_ideas = { remove_idea = PRS_idea_prussian_style_liberalism add_idea = PRS_idea_prussian_style_liberalism_2 }
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 25.7 compare = equals } }
		PRS = { add_ideas = PRS_idea_prussian_constitutionalism }
		hidden_effect = {
			if = {
				limit = { has_active_mission = PRS_mission_liberalize_prussia }
				clr_country_flag = PRS_liberalization_in_progress_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 25.8 compare = equals } }
		PRS = {
			if = {
				limit = { has_idea = limited_exports }
				swap_ideas = { remove_idea = limited_exports add_idea = export_focus }
			}
		}
		hidden_effect = {
			if = {
				limit = { has_active_mission = PRS_mission_liberalize_prussia }
				clr_country_flag = PRS_liberalization_in_progress_flag
			}
		}
	}

	# DANISH PARLIAMENT
	else_if = {
		limit = { check_variable = { current_reform_id = 26.1 compare = equals } }
		DEN = {
			add_ideas = DEN_idea_new_buisness_act
			add_political_power = 25
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.2 compare = equals } }
		DEN = {
			swap_ideas = {
				remove_idea = DEN_idea_icelandic_independence_movement_1
				add_idea = DEN_idea_icelandic_independence_movement_2
			}
			ICE = { add_state_core = 100 }
			add_political_power = 25
			add_stability = 0.025
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.3 compare = equals } }
		DEN = {
			37 = {
				add_extra_state_shared_building_slots = 1
				add_building_construction = { type = naval_base level = 1 instant_build = yes province = 6287 }
			}
			unlock_decision_tooltip = DEN_decision_holmen_naval_port_expansion
			hidden_effect = {
				set_country_flag = DEN_holmen_naval_port_expansion_ready_flag
				clr_country_flag = DEN_navy_reform_ongoing_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.4 compare = equals } }
		DEN = {
			custom_effect_tooltip = DEN_parl_vote_wartime_battalion_duplication_effect_tt
			add_political_power = 25
			hidden_effect = {
				set_country_flag = DEN_wartime_battalion_duplication_flag
				clr_country_flag = DEN_army_reform_ongoing_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.5 compare = equals } }
		DEN = {
			if = {
				limit = { has_idea = limited_conscription }
				swap_ideas = { remove_idea = limited_conscription add_idea = extensive_conscription }
			}
			else_if = {
				limit = { has_idea = early_conscription }
				swap_ideas = { remove_idea = early_conscription add_idea = limited_conscription }
			}
			else_if = {
				limit = { has_idea = volunteer_only }
				swap_ideas = { remove_idea = volunteer_only add_idea = early_conscription }
			}
			hidden_effect = {
				clr_country_flag = DEN_army_reform_ongoing_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.6 compare = equals } }
		DEN = {
			add_political_power = 25
			if = {
				limit = { has_idea = army_spending_level_3 }
				swap_ideas = { remove_idea = army_spending_level_3 add_idea = army_spending_level_4 }
			}
			else_if = {
				limit = { has_idea = army_spending_level_2 }
				swap_ideas = { remove_idea = army_spending_level_2 add_idea = army_spending_level_3 }
			}
			else_if = {
				limit = { has_idea = army_spending_level_1 }
				swap_ideas = { remove_idea = army_spending_level_1 add_idea = army_spending_level_2 }
			}
			hidden_effect = {
				clr_country_flag = DEN_army_reform_ongoing_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.7 compare = equals } }
		DEN = {
			add_political_power = 25
			if = {
				limit = { has_idea = navy_spending_level_3 }
				swap_ideas = { remove_idea = navy_spending_level_3 add_idea = navy_spending_level_4 }
			}
			else_if = {
				limit = { has_idea = navy_spending_level_2 }
				swap_ideas = { remove_idea = navy_spending_level_2 add_idea = navy_spending_level_3 }
			}
			else_if = {
				limit = { has_idea = navy_spending_level_1 }
				swap_ideas = { remove_idea = navy_spending_level_1 add_idea = navy_spending_level_3 }
			}
			hidden_effect = {
				clr_country_flag = DEN_navy_reform_ongoing_flag
			}
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.8 compare = equals } }
		DEN = {
			add_political_power = 25
			increase_legitimacy_by_five = yes
			if = {
				limit = { NOT = { has_variable = political_legitimacy_equilibrium_custom } }
				set_variable = { political_legitimacy_equilibrium_custom = 0.05 }
			}
			else = {
				add_to_variable = { political_legitimacy_equilibrium_custom = 0.05 }
			}
			add_popularity = { ideology = social_egalitarianism popularity = 0.05 }
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.9 compare = equals } }
		DEN = {
			if = {
				limit = { has_idea = limited_exports }
				swap_ideas = { remove_idea = limited_exports add_idea = free_trade }
			}
			else_if = {
				limit = { has_idea = export_focus }
				swap_ideas = { remove_idea = export_focus add_idea = free_trade }
			}
			add_popularity = { ideology = centrism popularity = 0.02 }
		}
	}
	else_if = {
		limit = { check_variable = { current_reform_id = 26.10 compare = equals } }
		DEN = {
			increase_ps_by_one = yes
			add_ideas = DEN_idea_the_helstaten
			add_stability = 0.05
			if = {
				limit = {
					58 = { is_claimed_by = DEN }
					1032 = { is_claimed_by = DEN }
				}
				remove_state_claim = 58
				remove_state_claim = 1032
			}
			every_country = {
				limit = { is_part_of_the_german_confederation = yes }
				add_opinion_modifier = { target = DEN modifier = DEN_PROTECT_THE_HELSTATEN_IDEA_REL }
				reverse_add_opinion_modifier = { target = DEN modifier = DEN_PROTECT_THE_HELSTATEN_IDEA_REL }
			}
		}
	}
}

set_deterministic_vote = {
	set_country_flag = parl_vote_deterministic
}

set_executive_cooldown = {
	set_country_flag = parl_executive_order_flag
	set_variable = { parl_executive_cooldown = 30 }
}


###################################################################################################

 	#      #####  #####  #####  #####  #####  #   #   ###    ###   #   #
 	#      #      #        #      #      #    ## ##  #   #  ##  #   # #
 	#      ##     #  ##    #      #      #    # # #  #####  #        #
 	#      #      #   #    #      #      #    #   #  #   #  ##  #    #
 	#####  #####  #####  #####    #    #####  #   #  #   #   ###     #

###################################################################################################

eoanb_political_legitimacy_reset = {
	randomize_variable = {
		var = political_legitimacy
		min = 0.55
		max = 0.75
	}
	eoanb_political_legitimacy_change = yes
}

eoanb_political_legitimacy_drift_calc = {
	# Equilibrium Base
	set_variable = { political_legitimacy_equilibrium = 0.68 }
	
	# Equilibrium Modifiers
	if = {
		limit = { is_subject = no }
		if = {
			limit = { has_offensive_war = yes }
			add_to_variable = { political_legitimacy_equilibrium = -0.05 }
		}
		if = {
			limit = { has_defensive_war = yes }
			add_to_variable = { political_legitimacy_equilibrium = 0.03 }
		}
	}
	else = {
		add_to_variable = { political_legitimacy_equilibrium = -0.05 }
	}
	if = {
		limit = { has_government = anarchism }
		add_to_variable = { political_legitimacy_equilibrium = -0.10 }
	}
	else = {
		if = {
			limit = {
				check_variable = { party_popularity@ruling_party < 0.35 }
				check_variable = { highest_party_popularity@exclude_ruling_party > 0.49 }
			}
			add_to_variable = { political_legitimacy_equilibrium = -0.10 }
		}
	}
	if = {
		limit = { check_variable = { pol_stability < -2 } }
		add_to_variable = { political_legitimacy_equilibrium = -0.09 }
	}
	else_if = {
		limit = { check_variable = { pol_stability = -2 } }
		add_to_variable = { political_legitimacy_equilibrium = -0.06 }
	}
	else_if = {
		limit = { check_variable = { pol_stability = -1 } }
		add_to_variable = { political_legitimacy_equilibrium = -0.03 }
	}
	else_if = {
		limit = { check_variable = { pol_stability = 1 } }
		add_to_variable = { political_legitimacy_equilibrium = 0.03 }
	}
	else_if = {
		limit = { check_variable = { pol_stability = 2 } }
		add_to_variable = { political_legitimacy_equilibrium = 0.06 }
	}
	else_if = {
		limit = { check_variable = { pol_stability = 3 } }
		add_to_variable = { political_legitimacy_equilibrium = 0.09 }
	}
	if = {
		limit = {
			OR = {
				has_idea = VIN_Spirit_Dinh_Dao_Opposition1
				has_idea = VIN_Spirit_Dinh_Dao_Opposition2
				has_idea = VIN_Spirit_Dinh_Dao_Opposition3
				has_idea = VIN_Spirit_Dinh_Dao_Opposition4
			}
		}
		add_to_variable = { political_legitimacy_equilibrium = -0.10 }
	}		
	if = {
		limit = { has_idea = edc_bankrupt }
		add_to_variable = { political_legitimacy_equilibrium = -0.30 }
	}
	else_if = {
		limit = { has_idea = edc_bankrupt_reduced }
		add_to_variable = { political_legitimacy_equilibrium = -0.15 }
	}
	if = {
		limit = { is_great_power = yes }
		add_to_variable = { political_legitimacy_equilibrium = 0.05 }
	}
	else_if = {
		limit = { is_secondary_power = yes }
		add_to_variable = { political_legitimacy_equilibrium = 0.03 }
	}
	else_if = {
		limit = { is_minor_power = yes }
		add_to_variable = { political_legitimacy_equilibrium = 0.01 }
	}
	add_to_variable = { political_legitimacy_equilibrium = political_legitimacy_equilibrium_custom }

	# Drift Calculation
	clamp_variable = {
		var = political_legitimacy_equilibrium
		min = 0.20
		max = 0.99
	}
	set_temp_variable = { political_legitimacy_equilibrium_difference = political_legitimacy_equilibrium }
	subtract_from_temp_variable = { political_legitimacy_equilibrium_difference = political_legitimacy }
	
	if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference < -0.29 } }
		set_variable = { political_legitimacy_drift = -0.04 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference < -0.19 } }
		set_variable = { political_legitimacy_drift = -0.03 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference < -0.09 } }
		set_variable = { political_legitimacy_drift = -0.02 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference < 0 } }
		set_variable = { political_legitimacy_drift = -0.01 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference > 0.29  } }
		set_variable = { political_legitimacy_drift = 0.04 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference > 0.19  } }
		set_variable = { political_legitimacy_drift = 0.03 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference > 0.09 } }
		set_variable = { political_legitimacy_drift = 0.02 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference > 0 } }
		set_variable = { political_legitimacy_drift = 0.01 }
	}
	else_if = {
		limit = { check_variable = { political_legitimacy_equilibrium_difference = 0 } }
		set_variable = { political_legitimacy_drift = 0.0 }
	}
}

# Monthly Legitimacy Drift
eoanb_political_legitimacy_drift = {

	# Initialize Legitimacy
	if = {
		limit = { NOT = { has_variable = political_legitimacy } }
		randomize_variable = {
			var = political_legitimacy
			distribution = uniform
			min = 0.6
			max = 0.8
		}
	}
	if = {
		limit = { NOT = { has_dynamic_modifier = { modifier = legitimacy_dynamic_modifier } } }
		add_dynamic_modifier = { modifier = legitimacy_dynamic_modifier }
	}

	eoanb_political_legitimacy_drift_calc = yes
	
	# Apply Drift
	set_temp_variable = { political_legitimacy_change = political_legitimacy_drift }
	eoanb_political_legitimacy_change = yes
}		

eoanb_political_legitimacy_change = {
	custom_effect_tooltip = eoanb_political_legitimacy_change_tt
	add_to_variable = { political_legitimacy = political_legitimacy_change }

	clamp_variable = {
		var = political_legitimacy
		min = 0
		max = 1
	}

	set_temp_variable = { full_legitimacy_temp_value = -0.70 }
	add_to_temp_variable = { full_legitimacy_temp_value = political_legitimacy }

	set_variable = { legitimacy_ppg = full_legitimacy_temp_value }
	divide_temp_variable = { full_legitimacy_temp_value = 2 }
	set_variable = { legitimacy_wsf = full_legitimacy_temp_value }
	multiply_temp_variable = { full_legitimacy_temp_value = -1 }
	set_variable = { legitimacy_pacf = full_legitimacy_temp_value }
}
